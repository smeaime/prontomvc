SELECT TOP (3000) [t18].[IdCartaDePorte], [t18].[value] AS [NumeroCartaDePorte], [t18].[value2] AS [NumeroCartaDePorteFormateada], [t18].[value3] AS [NumeroSubfijo], [t18].[value4] AS [SubnumeroVagon], [t18].[value5] AS [FechaArribo], [t18].[value6] AS [FechaModificacion2], [t18].[value7] AS [FechaDescarga], [t18].[Observaciones], [t18].[value8] AS [NobleExtranos], [t18].[value9] AS [NobleNegros], [t18].[value10] AS [NobleQuebrados], [t18].[value11] AS [NobleDaniados], [t18].[value12] AS [NobleChamico], [t18].[value13] AS [NobleChamico2], [t18].[value14] AS [NobleRevolcado], [t18].[value15] AS [NobleObjetables], [t18].[value16] AS [NobleAmohosados], [t18].[value17] AS [NobleHectolitrico], [t18].[value18] AS [NobleCarbon], [t18].[value19] AS [NoblePanzaBlanca], [t18].[value20] AS [NoblePicados], [t18].[value21] AS [NobleMGrasa], [t18].[value22] AS [NobleAcidezGrasa], [t18].[value23] AS [NobleVerdes], [t18].[value24] AS [NobleGrado], [t18].[value25] AS [NobleConforme], [t18].[value26] AS [NobleACamara], [t18].[value27] AS [CalidadPuntaSombreada], [t18].[value28] AS [CalidadGranosQuemados], [t18].[value29] AS [CalidadGranosQuemadosBonifRebaja], [t18].[value30] AS [CalidadTierra], [t18].[value31] AS [CalidadTierraBonifRebaja], [t18].[value32] AS [CalidadMermaChamico], [t18].[value33] AS [CalidadMermaChamicoBonifRebaja], [t18].[value34] AS [CalidadMermaZarandeo], [t18].[value35] AS [CalidadMermaZarandeoBonifRebaja], [t18].[value36] AS [TitularDesc], [t18].[value37] AS [IntermediarioDesc], [t18].[value38] AS [RComercialDesc], [t18].[value39] AS [CorredorDesc], [t18].[value40] AS [DestinatarioDesc], [t18].[value41] AS [TitularCUIT], [t18].[value42] AS [IntermediarioCUIT], [t18].[value43] AS [RComercialCUIT], [t18].[value44] AS [CorredorCUIT], [t18].[value45] AS [DestinatarioCUIT], [t18].[Procedencia] AS [IdProcedencia], [t18].[value46] AS [ProcedenciaDesc], [t18].[value47] AS [DestinoDesc], [t18].[Calidad] AS [CalidadDesc], [t18].[value48] AS [Producto], [t18].[value49] AS [NetoProc], [t18].[value50] AS [BrutoFinal], [t18].[value51] AS [TaraFinal], [t18].[value52] AS [NetoFinal], [t18].[value53] AS [Merma], [t18].[value54] AS [Humedad], [t18].[value55] AS [HumedadDesnormalizada], [t18].[value56] AS [ProcedenciaLocalidadONCCA_SAGPYA], [t18].[value57] AS [ProcedenciaPartidoONCCA], [t18].[Patente], [t18].[Acoplado], [t18].[value58] AS [DestinoCodigoYPF], [t18].[value59] AS [TransportistaCUIT], [t18].[value60] AS [TransportistaDesc], [t18].[value61] AS [ChoferCUIT], [t18].[value62] AS [ChoferDesc], [t18].[value63] AS [EspecieONCCA], [t18].[value64] AS [Cosecha], [t18].[value65] AS [Establecimiento], [t18].[value66] AS [IdFacturaImputada], [t18].[value67] AS [IdClienteAFacturarle], [t18].[value68] AS [IdDetalleFacturaImputada], [t18].[value69] AS [PrecioUnitarioTotal], [t18].[value70] AS [ClienteFacturado], [t18].[PathImagen], [t18].[value71] AS [NetoPto], [t18].[value72] AS [TaraPto], [t18].[value73] AS [BrutoPto], [t18].[CEE] AS [CEE_CAU], [t18].[value74] AS [DestinoCodigoSAGPYA], [t18].[Contrato], [t18].[value75] AS [PuntoVenta], [t18].[value76] AS [Cosecha2], [t18].[value77] AS [FechaDeCarga], [t18].[value78] AS [NRecibo], [t18].[value79] AS [ProcedenciaCodigoPostal], [t18].[value80] AS [DestinoCodigoPostal], [t18].[value81] AS [CalidadGranosDanadosRebaja], [t18].[value82] AS [CalidadGranosExtranosRebaja]
FROM (
    SELECT [t0].[IdCartaDePorte], [t0].[NumeroCartaDePorte] AS [value], (SUBSTRING(
        (CASE 
            WHEN (CONVERT(Int,DATALENGTH(CONVERT(NVarChar,[t0].[NumeroCartaDePorte])) / 2)) >= @p0 THEN CONVERT(NVarChar,[t0].[NumeroCartaDePorte])
            ELSE REPLICATE(@p1, @p0 - (CONVERT(Int,DATALENGTH(CONVERT(NVarChar,[t0].[NumeroCartaDePorte])) / 2))) + (CONVERT(NVarChar,[t0].[NumeroCartaDePorte]))
         END), @p2 + 1, @p3) + @p4) + SUBSTRING(
        (CASE 
            WHEN (CONVERT(Int,DATALENGTH(CONVERT(NVarChar,[t0].[NumeroCartaDePorte])) / 2)) >= @p5 THEN CONVERT(NVarChar,[t0].[NumeroCartaDePorte])
            ELSE REPLICATE(@p6, @p5 - (CONVERT(Int,DATALENGTH(CONVERT(NVarChar,[t0].[NumeroCartaDePorte])) / 2))) + (CONVERT(NVarChar,[t0].[NumeroCartaDePorte]))
         END), @p7 + 1, @p8) AS [value2], [t0].[NumeroSubfijo] AS [value3], [t0].[SubnumeroVagon] AS [value4], [t0].[FechaArribo] AS [value5], [t0].[FechaModificacion] AS [value6], [t0].[FechaDescarga] AS [value7], [t0].[Observaciones], [t0].[NobleExtranos] AS [value8], [t0].[NobleNegros] AS [value9], [t0].[NobleQuebrados] AS [value10], [t0].[NobleDaniados] AS [value11], [t0].[NobleChamico] AS [value12], [t0].[NobleChamico2] AS [value13], [t0].[NobleRevolcado] AS [value14], [t0].[NobleObjetables] AS [value15], [t0].[NobleAmohosados] AS [value16], [t0].[NobleObjetables] AS [value17], [t0].[NobleHectolitrico] AS [value18], [t0].[NoblePanzaBlanca] AS [value19], [t0].[NoblePicados] AS [value20], [t0].[NobleMGrasa] AS [value21], [t0].[NobleAcidezGrasa] AS [value22], [t0].[NobleVerdes] AS [value23], [t0].[NobleGrado] AS [value24], CONVERT(Bit,[t0].[NobleConforme]) AS [value25], 
        (CASE 
            WHEN [t0].[NobleACamara] = @p9 THEN 1
            WHEN NOT ([t0].[NobleACamara] = @p9) THEN 0
            ELSE NULL
         END) AS [value26], CONVERT(Float,COALESCE([t0].[CalidadPuntaSombreada],@p10)) AS [value27], CONVERT(Float,COALESCE([t0].[CalidadGranosQuemados],@p11)) AS [value28], 
        (CASE 
            WHEN [t0].[CalidadGranosQuemadosBonifica_o_Rebaja] IS NULL THEN @p12
            ELSE CONVERT(Int,CONVERT(NVarChar(2),[t0].[CalidadGranosQuemadosBonifica_o_Rebaja]))
         END) AS [value29], CONVERT(Float,COALESCE([t0].[CalidadTierra],@p13)) AS [value30], CONVERT(Int,COALESCE([t0].[CalidadPuntaSombreada],@p14)) AS [value31], CONVERT(Float,COALESCE([t0].[CalidadMermaChamico],@p15)) AS [value32], 
        (CASE 
            WHEN [t0].[CalidadMermaChamicoBonifica_o_Rebaja] IS NULL THEN @p16
            ELSE CONVERT(Int,CONVERT(NVarChar(2),[t0].[CalidadMermaChamicoBonifica_o_Rebaja]))
         END) AS [value33], CONVERT(Float,COALESCE([t0].[CalidadMermaZarandeo],@p17)) AS [value34], 
        (CASE 
            WHEN [t0].[CalidadMermaZarandeoBonifica_o_Rebaja] IS NULL THEN @p18
            ELSE CONVERT(Int,CONVERT(NVarChar(2),[t0].[CalidadMermaZarandeoBonifica_o_Rebaja]))
         END) AS [value35], [t2].[RazonSocial] AS [value36], [t4].[RazonSocial] AS [value37], [t5].[RazonSocial] AS [value38], [t6].[Nombre] AS [value39], [t3].[RazonSocial] AS [value40], REPLACE([t2].[Cuit], @p19, @p20) AS [value41], REPLACE([t4].[Cuit], @p21, @p22) AS [value42], REPLACE([t5].[Cuit], @p23, @p24) AS [value43], REPLACE([t6].[Cuit], @p25, @p26) AS [value44], REPLACE([t3].[Cuit], @p27, @p28) AS [value45], [t0].[Procedencia], [t8].[Nombre] AS [value46], [t7].[Descripcion] AS [value47], [t0].[Calidad], [t1].[Descripcion] AS [value48], [t0].[NetoProc] AS [value49], [t0].[BrutoFinal] AS [value50], [t0].[TaraFinal] AS [value51], [t0].[NetoFinal] AS [value52], [t0].[Merma] AS [value53], [t0].[Humedad] AS [value54], [t0].[HumedadDesnormalizada] AS [value55], [t8].[CodigoONCAA] AS [value56], [t12].[CodigoONCCA] AS [value57], [t0].[Patente], [t0].[Acoplado], [t7].[CodigoYPF] AS [value58], REPLACE([t11].[Cuit], @p29, @p30) AS [value59], [t11].[RazonSocial] AS [value60], REPLACE([t13].[CUIL], @p31, @p32) AS [value61], [t13].[Nombre] AS [value62], [t1].[AuxiliarString6] AS [value63], REPLACE([t0].[Cosecha], @p33, @p34) AS [value64], [t10].[Descripcion] AS [value65], COALESCE([t0].[IdFacturaImputada],@p35) AS [value66], COALESCE([t0].[IdClienteAFacturarle],@p36) AS [value67], COALESCE([t0].[IdDetalleFactura],@p37) AS [value68], COALESCE([t16].[PrecioUnitarioTotal],@p38) AS [value69], [t17].[RazonSocial] AS [value70], [t0].[PathImagen], [t0].[NetoPto] AS [value71], [t0].[TaraPto] AS [value72], [t0].[BrutoPto] AS [value73], [t0].[CEE], [t7].[CodigoONCAA] AS [value74], [t0].[Contrato], COALESCE([t0].[PuntoVenta],@p39) AS [value75], REPLACE(REPLACE([t0].[Cosecha], @p40, @p41), @p42, @p43) AS [value76], COALESCE([t0].[FechaDeCarga],[t0].[FechaArribo]) AS [value77], CONVERT(NVarChar,CONVERT(Int,[t0].[NRecibo])) AS [value78], [t8].[CodigoPostal] AS [value79], [t7].[CodigoPostal] AS [value80], COALESCE([t0].[CalidadGranosDanadosRebaja],@p44) AS [value81], COALESCE([t0].[CalidadGranosExtranosRebaja],@p45) AS [value82], [t0].[Vendedor], [t0].[FechaDescarga], [t0].[Anulada], [t0].[Corredor], [t0].[Entregador], [t0].[PuntoVenta], [t0].[FechaModificacion]
    FROM [dbo].[CartasDePorte] AS [t0]
    LEFT OUTER JOIN [dbo].[Articulos] AS [t1] ON ([t1].[IdArticulo]) = [t0].[IdArticulo]
    LEFT OUTER JOIN [dbo].[Clientes] AS [t2] ON ([t2].[IdCliente]) = [t0].[Vendedor]
    LEFT OUTER JOIN [dbo].[Clientes] AS [t3] ON ([t3].[IdCliente]) = [t0].[Entregador]
    LEFT OUTER JOIN [dbo].[Clientes] AS [t4] ON ([t4].[IdCliente]) = [t0].[CuentaOrden1]
    LEFT OUTER JOIN [dbo].[Clientes] AS [t5] ON ([t5].[IdCliente]) = [t0].[CuentaOrden2]
    LEFT OUTER JOIN [dbo].[Vendedores] AS [t6] ON ([t6].[IdVendedor]) = [t0].[Corredor]
    LEFT OUTER JOIN [dbo].[WilliamsDestinos] AS [t7] ON ([t7].[IdWilliamsDestino]) = [t0].[Destino]
    LEFT OUTER JOIN [dbo].[Localidades] AS [t8] ON [t8].[IdLocalidad] = (CONVERT(Int,[t0].[Procedencia]))
    LEFT OUTER JOIN [dbo].[Calidades] AS [t9] ON (CONVERT(Float,[t9].[IdCalidad])) = (CONVERT(Float,[t0].[Calidad]))
    LEFT OUTER JOIN [dbo].[CDPEstablecimientos] AS [t10] ON ([t10].[IdEstablecimiento]) = [t0].[IdEstablecimiento]
    LEFT OUTER JOIN [dbo].[Transportistas] AS [t11] ON ([t11].[IdTransportista]) = [t0].[IdTransportista]
    LEFT OUTER JOIN [dbo].[Partidos] AS [t12] ON ([t12].[IdPartido]) = [t8].[IdPartido]
    LEFT OUTER JOIN [dbo].[Choferes] AS [t13] ON ([t13].[IdChofer]) = [t0].[IdChofer]
    LEFT OUTER JOIN [dbo].[Empleados] AS [t14] ON ([t14].[IdEmpleado]) = [t0].[IdUsuarioIngreso]
    LEFT OUTER JOIN [dbo].[Facturas] AS [t15] ON ([t15].[IdFactura]) = [t0].[IdFacturaImputada]
    LEFT OUTER JOIN [dbo].[DetalleFacturas] AS [t16] ON ([t16].[IdDetalleFactura]) = [t0].[IdDetalleFactura]
    LEFT OUTER JOIN [dbo].[Clientes] AS [t17] ON ([t17].[IdCliente]) = [t15].[IdCliente]
    ) AS [t18]
WHERE ([t18].[Vendedor] > @p46) AND ([t18].[FechaDescarga] >= @p47) AND ([t18].[FechaDescarga] <= @p48) AND ((1) = 1) AND ([t18].[Anulada] <> @p49) AND ((1) = 1) AND (([t18].[Vendedor] IS NOT NULL) AND ([t18].[Corredor] IS NOT NULL) AND ([t18].[Entregador] IS NOT NULL)) AND ([t18].[PuntoVenta] = @p50) AND ((1) = 1)
ORDER BY [t18].[FechaModificacion] DESC
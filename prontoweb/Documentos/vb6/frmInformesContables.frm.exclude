VERSION 5.00
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "mscomctl.ocx"
Object = "{3B7C8863-D78F-101B-B9B5-04021C009402}#1.2#0"; "richtx32.ocx"
Object = "{86CF1D34-0C5F-11D2-A9FC-0000F8754DA1}#2.0#0"; "mscomct2.ocx"
Object = "{F0D2F211-CCB0-11D0-A316-00AA00688B10}#1.0#0"; "MSDATLST.OCX"
Object = "{12DE615C-8D4B-4936-8801-459AB2EAA3FC}#1.2#0"; "Controles1013.ocx"
Begin VB.Form frmInformesContables 
   Caption         =   "Consultas"
   ClientHeight    =   7815
   ClientLeft      =   60
   ClientTop       =   345
   ClientWidth     =   11820
   Icon            =   "frmInformesContables.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   7815
   ScaleWidth      =   11820
   StartUpPosition =   2  'CenterScreen
   Begin VB.CheckBox Check9 
      Alignment       =   1  'Right Justify
      Caption         =   "Check9"
      Height          =   240
      Left            =   1080
      TabIndex        =   77
      Top             =   1260
      Visible         =   0   'False
      Width           =   2355
   End
   Begin VB.CheckBox Check8 
      Alignment       =   1  'Right Justify
      Caption         =   "Check8"
      Height          =   240
      Left            =   405
      TabIndex        =   76
      Top             =   1260
      Visible         =   0   'False
      Width           =   2355
   End
   Begin VB.CheckBox Check7 
      Alignment       =   1  'Right Justify
      Caption         =   "Check7"
      Height          =   240
      Left            =   1305
      TabIndex        =   75
      Top             =   1260
      Visible         =   0   'False
      Width           =   2355
   End
   Begin VB.Frame Frame7 
      Caption         =   "Nivel de subtotales : "
      Height          =   825
      Left            =   1395
      TabIndex        =   59
      Top             =   7380
      Visible         =   0   'False
      Width           =   2580
      Begin VB.CheckBox Check3 
         Caption         =   "Check3"
         Height          =   195
         Index           =   4
         Left            =   2115
         TabIndex        =   69
         Top             =   585
         Width           =   195
      End
      Begin VB.CheckBox Check3 
         Caption         =   "Check3"
         Height          =   195
         Index           =   3
         Left            =   1641
         TabIndex        =   68
         Top             =   585
         Width           =   195
      End
      Begin VB.CheckBox Check3 
         Caption         =   "Check3"
         Height          =   195
         Index           =   2
         Left            =   1169
         TabIndex        =   67
         Top             =   585
         Width           =   195
      End
      Begin VB.CheckBox Check3 
         Caption         =   "Check3"
         Height          =   195
         Index           =   1
         Left            =   697
         TabIndex        =   66
         Top             =   585
         Width           =   195
      End
      Begin VB.CheckBox Check3 
         Caption         =   "Check3"
         Height          =   195
         Index           =   0
         Left            =   225
         TabIndex        =   65
         Top             =   585
         Width           =   195
      End
      Begin VB.TextBox txtNivel 
         Alignment       =   2  'Center
         Height          =   285
         Index           =   4
         Left            =   1995
         Locked          =   -1  'True
         TabIndex        =   64
         Text            =   "000"
         Top             =   225
         Width           =   420
      End
      Begin VB.TextBox txtNivel 
         Alignment       =   2  'Center
         Height          =   285
         Index           =   3
         Left            =   1530
         Locked          =   -1  'True
         TabIndex        =   63
         Text            =   "00"
         Top             =   225
         Width           =   420
      End
      Begin VB.TextBox txtNivel 
         Alignment       =   2  'Center
         Height          =   285
         Index           =   2
         Left            =   1065
         Locked          =   -1  'True
         TabIndex        =   62
         Text            =   "00"
         Top             =   225
         Width           =   420
      End
      Begin VB.TextBox txtNivel 
         Alignment       =   2  'Center
         Height          =   285
         Index           =   1
         Left            =   600
         Locked          =   -1  'True
         TabIndex        =   61
         Text            =   "0"
         Top             =   225
         Width           =   420
      End
      Begin VB.TextBox txtNivel 
         Alignment       =   2  'Center
         Height          =   285
         Index           =   0
         Left            =   135
         Locked          =   -1  'True
         TabIndex        =   60
         Text            =   "0"
         Top             =   225
         Width           =   420
      End
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Left            =   10170
      TabIndex        =   57
      Text            =   "Text3"
      Top             =   1215
      Visible         =   0   'False
      Width           =   690
   End
   Begin VB.CheckBox Check2 
      Alignment       =   1  'Right Justify
      Caption         =   "Check2"
      Height          =   240
      Left            =   3645
      TabIndex        =   56
      Top             =   1215
      Visible         =   0   'False
      Width           =   2355
   End
   Begin VB.Frame Frame6 
      Height          =   735
      Left            =   180
      TabIndex        =   52
      Top             =   5760
      Visible         =   0   'False
      Width           =   1860
      Begin VB.OptionButton Option13 
         Height          =   195
         Left            =   90
         TabIndex        =   54
         Top             =   405
         Width           =   1680
      End
      Begin VB.OptionButton Option12 
         Height          =   195
         Left            =   90
         TabIndex        =   53
         Top             =   180
         Width           =   1680
      End
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Left            =   10575
      TabIndex        =   45
      Text            =   "Text2"
      Top             =   6705
      Visible         =   0   'False
      Width           =   690
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Left            =   9045
      TabIndex        =   43
      Text            =   "Text1"
      Top             =   6705
      Visible         =   0   'False
      Width           =   690
   End
   Begin VB.Frame Frame4 
      Height          =   825
      Left            =   2745
      TabIndex        =   29
      Top             =   5715
      Visible         =   0   'False
      Width           =   8250
      Begin VB.OptionButton Option9 
         Caption         =   "Desc."
         Height          =   240
         Left            =   7470
         TabIndex        =   48
         Top             =   495
         Width           =   735
      End
      Begin VB.OptionButton Option8 
         Caption         =   "Cod."
         Height          =   240
         Left            =   6795
         TabIndex        =   47
         Top             =   495
         Width           =   645
      End
      Begin VB.CheckBox Check1 
         Height          =   195
         Left            =   3150
         TabIndex        =   31
         Top             =   180
         Width           =   195
      End
      Begin VB.TextBox txtCodigoCuenta 
         BeginProperty DataFormat 
            Type            =   0
            Format          =   """$""#.##0,00"
            HaveTrueFalseNull=   0
            FirstDayOfWeek  =   0
            FirstWeekOfYear =   0
            LCID            =   11274
            SubFormatType   =   0
         EndProperty
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   810
         TabIndex        =   30
         Top             =   450
         Width           =   915
      End
      Begin MSDataListLib.DataCombo DataCombo2 
         Height          =   315
         Index           =   0
         Left            =   810
         TabIndex        =   32
         Tag             =   "Obras"
         Top             =   135
         Width           =   1695
         _ExtentX        =   2990
         _ExtentY        =   556
         _Version        =   393216
         ListField       =   "Titulo"
         BoundColumn     =   "IdObra"
         Text            =   ""
      End
      Begin MSDataListLib.DataCombo DataCombo2 
         Height          =   315
         Index           =   1
         Left            =   3375
         TabIndex        =   33
         Tag             =   "CuentasGastos"
         Top             =   135
         Width           =   2100
         _ExtentX        =   3704
         _ExtentY        =   556
         _Version        =   393216
         ListField       =   "Titulo"
         BoundColumn     =   "IdCuentaGasto"
         Text            =   ""
      End
      Begin MSDataListLib.DataCombo DataCombo2 
         Height          =   315
         Index           =   2
         Left            =   6075
         TabIndex        =   34
         Tag             =   "TiposCuentaGrupos"
         Top             =   135
         Width           =   2085
         _ExtentX        =   3678
         _ExtentY        =   556
         _Version        =   393216
         ListField       =   "Titulo"
         BoundColumn     =   "IdTipoCuentaGrupo"
         Text            =   ""
      End
      Begin MSDataListLib.DataCombo DataCombo2 
         Height          =   315
         Index           =   3
         Left            =   1755
         TabIndex        =   35
         Tag             =   "Cuentas"
         Top             =   450
         Width           =   5025
         _ExtentX        =   8864
         _ExtentY        =   556
         _Version        =   393216
         ListField       =   "Titulo"
         BoundColumn     =   "IdCuenta"
         Text            =   ""
      End
      Begin VB.Label lblCuenta 
         Caption         =   "Obra :"
         Height          =   210
         Index           =   0
         Left            =   90
         TabIndex        =   39
         Top             =   180
         Width           =   690
      End
      Begin VB.Label lblCuenta 
         Caption         =   "Cta.gs.:"
         Height          =   210
         Index           =   1
         Left            =   2520
         TabIndex        =   38
         Top             =   180
         Width           =   555
      End
      Begin VB.Label lblCuenta 
         Caption         =   "Grupo :"
         Height          =   210
         Index           =   2
         Left            =   5490
         TabIndex        =   37
         Top             =   180
         Width           =   555
      End
      Begin VB.Label lblCuenta 
         Caption         =   "Cuenta :"
         Height          =   210
         Index           =   3
         Left            =   90
         TabIndex        =   36
         Top             =   495
         Width           =   690
      End
   End
   Begin VB.Frame Frame3 
      Caption         =   "Nivel de detalle : "
      Height          =   645
      Left            =   4230
      TabIndex        =   25
      Top             =   6660
      Visible         =   0   'False
      Width           =   2220
      Begin VB.OptionButton Option5 
         Caption         =   "Hasta nivel cuenta"
         Height          =   195
         Left            =   90
         TabIndex        =   27
         Top             =   180
         Width           =   1770
      End
      Begin VB.OptionButton Option6 
         Caption         =   "Hasta nivel comprobante"
         Height          =   195
         Left            =   90
         TabIndex        =   26
         Top             =   405
         Width           =   2085
      End
   End
   Begin VB.Frame Frame2 
      Caption         =   "Cuentas de gastos  : "
      Height          =   645
      Left            =   1395
      TabIndex        =   21
      Top             =   6660
      Visible         =   0   'False
      Width           =   2760
      Begin VB.OptionButton Option4 
         Caption         =   "Detalladas por centro de gasto"
         Height          =   195
         Left            =   90
         TabIndex        =   23
         Top             =   405
         Width           =   2580
      End
      Begin VB.OptionButton Option3 
         Caption         =   "Resumidas en cuenta madre"
         Height          =   195
         Left            =   90
         TabIndex        =   22
         Top             =   180
         Width           =   2400
      End
   End
   Begin VB.Frame Frame1 
      Caption         =   "Cuentas : "
      Height          =   825
      Left            =   90
      TabIndex        =   18
      Top             =   495
      Visible         =   0   'False
      Width           =   1860
      Begin VB.OptionButton Option7 
         Caption         =   "Una"
         Height          =   195
         Left            =   1080
         TabIndex        =   28
         Top             =   225
         Width           =   645
      End
      Begin VB.OptionButton Option1 
         Caption         =   "Todas"
         Height          =   195
         Left            =   90
         TabIndex        =   20
         Top             =   225
         Width           =   780
      End
      Begin VB.OptionButton Option2 
         Caption         =   "Elegir desde hasta"
         Height          =   195
         Left            =   90
         TabIndex        =   19
         Top             =   495
         Width           =   1680
      End
   End
   Begin VB.TextBox txtAnio 
      BeginProperty DataFormat 
         Type            =   0
         Format          =   """$""#.##0,00"
         HaveTrueFalseNull=   0
         FirstDayOfWeek  =   0
         FirstWeekOfYear =   0
         LCID            =   11274
         SubFormatType   =   0
      EndProperty
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Left            =   10710
      TabIndex        =   16
      Top             =   900
      Visible         =   0   'False
      Width           =   780
   End
   Begin VB.TextBox txtProcesando 
      BeginProperty DataFormat 
         Type            =   0
         Format          =   """$""#.##0,00"
         HaveTrueFalseNull=   0
         FirstDayOfWeek  =   0
         FirstWeekOfYear =   0
         LCID            =   11274
         SubFormatType   =   0
      EndProperty
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   6480
      Locked          =   -1  'True
      TabIndex        =   12
      Top             =   6975
      Visible         =   0   'False
      Width           =   5280
   End
   Begin VB.TextBox txtCodigoHasta 
      BeginProperty DataFormat 
         Type            =   0
         Format          =   """$""#.##0,00"
         HaveTrueFalseNull=   0
         FirstDayOfWeek  =   0
         FirstWeekOfYear =   0
         LCID            =   11274
         SubFormatType   =   0
      EndProperty
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   3195
      TabIndex        =   1
      Top             =   900
      Width           =   1230
   End
   Begin VB.TextBox txtCodigoDesde 
      BeginProperty DataFormat 
         Type            =   0
         Format          =   """$""#.##0,00"
         HaveTrueFalseNull=   0
         FirstDayOfWeek  =   0
         FirstWeekOfYear =   0
         LCID            =   11274
         SubFormatType   =   0
      EndProperty
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   3195
      TabIndex        =   0
      Top             =   540
      Width           =   1230
   End
   Begin VB.CommandButton cmd 
      Caption         =   "&Procesar"
      Height          =   345
      Index           =   0
      Left            =   90
      TabIndex        =   4
      Top             =   6660
      Width           =   1215
   End
   Begin VB.CommandButton cmd 
      Caption         =   "&Salir"
      Height          =   345
      Index           =   1
      Left            =   90
      TabIndex        =   7
      Top             =   7020
      Width           =   1215
   End
   Begin MSDataListLib.DataCombo DataCombo1 
      Height          =   315
      Index           =   0
      Left            =   4545
      TabIndex        =   5
      Tag             =   "Cuentas"
      Top             =   540
      Width           =   3795
      _ExtentX        =   6694
      _ExtentY        =   556
      _Version        =   393216
      ListField       =   "Titulo"
      BoundColumn     =   "IdCuenta"
      Text            =   ""
   End
   Begin MSComCtl2.DTPicker DTFields 
      DataField       =   "FechaComprobante"
      Height          =   285
      Index           =   0
      Left            =   9315
      TabIndex        =   2
      Top             =   540
      Width           =   1290
      _ExtentX        =   2275
      _ExtentY        =   503
      _Version        =   393216
      Format          =   58130433
      CurrentDate     =   36377
   End
   Begin MSDataListLib.DataCombo DataCombo1 
      Height          =   315
      Index           =   1
      Left            =   4545
      TabIndex        =   6
      Tag             =   "Cuentas"
      Top             =   900
      Width           =   3795
      _ExtentX        =   6694
      _ExtentY        =   556
      _Version        =   393216
      ListField       =   "Titulo"
      BoundColumn     =   "IdCuenta"
      Text            =   ""
   End
   Begin MSComCtl2.DTPicker DTFields 
      DataField       =   "FechaComprobante"
      Height          =   285
      Index           =   1
      Left            =   9315
      TabIndex        =   3
      Top             =   900
      Width           =   1290
      _ExtentX        =   2275
      _ExtentY        =   503
      _Version        =   393216
      Format          =   58130433
      CurrentDate     =   36377
   End
   Begin Controles1013.DbListView Lista 
      Height          =   5235
      Left            =   45
      TabIndex        =   13
      Top             =   1395
      Width           =   11715
      _ExtentX        =   20664
      _ExtentY        =   9234
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MouseIcon       =   "frmInformesContables.frx":076A
      Sorted          =   0   'False
      ColumnHeaderIcons=   "ImgColumnas"
   End
   Begin MSComctlLib.ImageList imlToolbarIcons 
      Left            =   11160
      Top             =   6660
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   9
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmInformesContables.frx":0786
            Key             =   "Imprimir"
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmInformesContables.frx":0898
            Key             =   "Buscar"
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmInformesContables.frx":09AA
            Key             =   "Ayuda"
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmInformesContables.frx":0ABC
            Key             =   "Print"
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmInformesContables.frx":0BCE
            Key             =   "Find"
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmInformesContables.frx":0CE0
            Key             =   "Help"
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmInformesContables.frx":0DF2
            Key             =   "Excel"
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmInformesContables.frx":1244
            Key             =   "Word"
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "frmInformesContables.frx":17DE
            Key             =   "Pdf"
         EndProperty
      EndProperty
   End
   Begin MSComctlLib.Toolbar Toolbar1 
      Align           =   1  'Align Top
      Height          =   420
      Left            =   0
      TabIndex        =   14
      Top             =   0
      Width           =   11820
      _ExtentX        =   20849
      _ExtentY        =   741
      ButtonWidth     =   609
      ButtonHeight    =   582
      Appearance      =   1
      ImageList       =   "imlToolbarIcons"
      _Version        =   393216
      BeginProperty Buttons {66833FE8-8583-11D1-B16A-00C0F0283628} 
         NumButtons      =   9
         BeginProperty Button1 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Key             =   "Imprimir"
            Object.ToolTipText     =   "Imprimir"
            ImageKey        =   "Print"
         EndProperty
         BeginProperty Button2 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Style           =   3
         EndProperty
         BeginProperty Button3 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Key             =   "Excel"
            Object.ToolTipText     =   "Salida a Excel"
            ImageKey        =   "Excel"
         EndProperty
         BeginProperty Button4 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Style           =   3
         EndProperty
         BeginProperty Button5 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Key             =   "Buscar"
            Object.ToolTipText     =   "Buscar"
            ImageKey        =   "Find"
         EndProperty
         BeginProperty Button6 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Style           =   3
         EndProperty
         BeginProperty Button7 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Key             =   "Diario"
            Object.ToolTipText     =   "Emitir diario en formato Word"
            ImageKey        =   "Word"
         EndProperty
         BeginProperty Button8 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Style           =   3
         EndProperty
         BeginProperty Button9 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Key             =   "Pdf"
            ImageKey        =   "Pdf"
         EndProperty
      EndProperty
   End
   Begin MSComctlLib.StatusBar StatusBar1 
      Align           =   2  'Align Bottom
      Height          =   390
      Left            =   0
      TabIndex        =   17
      Top             =   7425
      Width           =   11820
      _ExtentX        =   20849
      _ExtentY        =   688
      _Version        =   393216
      BeginProperty Panels {8E3867A5-8586-11D1-B16A-00C0F0283628} 
         NumPanels       =   5
         BeginProperty Panel1 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            AutoSize        =   1
            Object.Width           =   8414
            Key             =   "Mensaje"
         EndProperty
         BeginProperty Panel2 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            AutoSize        =   1
            Object.Width           =   8414
            Picture         =   "frmInformesContables.frx":20B8
            Key             =   "Estado"
         EndProperty
         BeginProperty Panel3 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   1
            Alignment       =   1
            AutoSize        =   2
            Enabled         =   0   'False
            Object.Width           =   900
            MinWidth        =   18
            TextSave        =   "CAPS"
            Key             =   "Caps"
         EndProperty
         BeginProperty Panel4 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   2
            AutoSize        =   2
            Object.Width           =   820
            MinWidth        =   18
            TextSave        =   "NUM"
            Key             =   "Num"
         EndProperty
         BeginProperty Panel5 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Style           =   6
            Alignment       =   1
            AutoSize        =   2
            Object.Width           =   1693
            MinWidth        =   18
            TextSave        =   "25/09/2009"
            Key             =   "Fecha"
         EndProperty
      EndProperty
   End
   Begin VB.Frame Frame5 
      Caption         =   "Cuentas :"
      Height          =   645
      Left            =   10710
      TabIndex        =   49
      Top             =   540
      Visible         =   0   'False
      Width           =   1005
      Begin VB.OptionButton Option11 
         Caption         =   "x Desc."
         Height          =   195
         Left            =   90
         TabIndex        =   51
         Top             =   405
         Width           =   870
      End
      Begin VB.OptionButton Option10 
         Caption         =   "x Cod."
         Height          =   195
         Left            =   90
         TabIndex        =   50
         Top             =   180
         Width           =   825
      End
   End
   Begin VB.ComboBox Combo1 
      Height          =   315
      ItemData        =   "frmInformesContables.frx":23D2
      Left            =   10710
      List            =   "frmInformesContables.frx":23FD
      TabIndex        =   15
      Text            =   "Combo1"
      Top             =   540
      Visible         =   0   'False
      Width           =   1050
   End
   Begin RichTextLib.RichTextBox rchObservaciones 
      Height          =   150
      Left            =   8460
      TabIndex        =   55
      Top             =   1260
      Visible         =   0   'False
      Width           =   690
      _ExtentX        =   1217
      _ExtentY        =   265
      _Version        =   393217
      ScrollBars      =   2
      TextRTF         =   $"frmInformesContables.frx":2465
   End
   Begin VB.Frame Frame8 
      Height          =   870
      Left            =   10665
      TabIndex        =   71
      Top             =   495
      Visible         =   0   'False
      Width           =   1095
      Begin VB.CheckBox Check6 
         Height          =   195
         Left            =   90
         TabIndex        =   74
         Top             =   630
         Width           =   915
      End
      Begin VB.CheckBox Check5 
         Height          =   195
         Left            =   90
         TabIndex        =   73
         Top             =   405
         Width           =   915
      End
      Begin VB.CheckBox Check4 
         Height          =   195
         Left            =   90
         TabIndex        =   72
         Top             =   180
         Width           =   915
      End
   End
   Begin VB.Label lblInfo 
      Alignment       =   2  'Center
      BackColor       =   &H00C0C0FF&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   13.5
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Left            =   1305
      TabIndex        =   70
      Top             =   6750
      Visible         =   0   'False
      Width           =   420
   End
   Begin VB.Label Label5 
      Caption         =   "Label5"
      Height          =   285
      Left            =   9405
      TabIndex        =   58
      Top             =   1215
      Visible         =   0   'False
      Width           =   690
   End
   Begin VB.Label Label4 
      Caption         =   "Label4"
      Height          =   285
      Left            =   9810
      TabIndex        =   46
      Top             =   6705
      Visible         =   0   'False
      Width           =   690
   End
   Begin VB.Label Label3 
      Caption         =   "Label3"
      Height          =   285
      Left            =   8280
      TabIndex        =   44
      Top             =   6705
      Visible         =   0   'False
      Width           =   690
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      BackColor       =   &H00C0C0FF&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   645
      Left            =   2655
      TabIndex        =   42
      Top             =   6660
      Visible         =   0   'False
      Width           =   1950
   End
   Begin VB.Label Label1 
      Alignment       =   2  'Center
      BackColor       =   &H00C0C0FF&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   870
      Left            =   5355
      TabIndex        =   41
      Top             =   5850
      Visible         =   0   'False
      Width           =   6450
   End
   Begin VB.Label lblLabels 
      Caption         =   "Periodo :"
      Height          =   210
      Index           =   5
      Left            =   6345
      TabIndex        =   40
      Top             =   1215
      Visible         =   0   'False
      Width           =   690
   End
   Begin VB.Label lblLabels 
      Caption         =   "Cuenta en proceso :"
      Height          =   210
      Index           =   4
      Left            =   6525
      TabIndex        =   24
      Top             =   6750
      Visible         =   0   'False
      Width           =   1545
   End
   Begin VB.Label lblLabels 
      Caption         =   "Hasta el :"
      Height          =   255
      Index           =   3
      Left            =   8460
      TabIndex        =   11
      Top             =   945
      Width           =   780
   End
   Begin VB.Label lblLabels 
      Caption         =   "Hasta cuenta :"
      Height          =   300
      Index           =   1
      Left            =   2025
      TabIndex        =   10
      Top             =   915
      Width           =   1140
   End
   Begin VB.Label lblLabels 
      Caption         =   "Desde el :"
      Height          =   255
      Index           =   2
      Left            =   8460
      TabIndex        =   9
      Top             =   585
      Width           =   780
   End
   Begin VB.Label lblLabels 
      Caption         =   "Desde cuenta :"
      Height          =   300
      Index           =   0
      Left            =   2025
      TabIndex        =   8
      Top             =   555
      Width           =   1140
   End
End
Attribute VB_Name = "frmInformesContables"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private mvarConculta As String, mvarVector_X As String, mvarVector_T As String
Private mvarSubTituloExcel As String, mvarDirectorioDTS As String
Private mvarIdInforme As Integer, mvarCodigoInforme As Integer
Private mvarLineasDiarioDetallado As Integer, mvarLineasDiarioResumido As Integer
Private mvarValidate As Boolean
Private mNivelAcceso As Integer

Public Property Let NivelAcceso(ByVal mNivelA As EnumAccesos)
   
   mNivelAcceso = mNivelA
   
End Property

Public Property Get NivelAcceso() As EnumAccesos

   NivelAcceso = mNivelAcceso
   
End Property

Public Property Let Id(ByVal vNewValue As String)

   mvarIdInforme = vNewValue
   mvarCodigoInforme = Val(vNewValue)
   mvarValidate = True
   mvarVector_X = ""
   mvarVector_T = ""
   
   Toolbar1.Buttons(7).Visible = False
   Toolbar1.Buttons(9).Visible = False
   
   Dim oRs As ADOR.Recordset
   Dim i As Integer
   
'   Set oRs = Aplicacion.TablasGenerales.TraerFiltrado("InformesContables", "_T", mvarIdInforme)
'   If oRs.RecordCount > 0 Then
'      mvarCodigoInforme = oRs.Fields("CodigoInforme").Value
'      mvarVector_X = oRs.Fields("InformeVector_X").Value
'      mvarVector_T = oRs.Fields("InformeVector_T").Value
'   End If
'   oRs.Close
'   Set oRs = Nothing
   
   Select Case mvarCodigoInforme
      Case 0
         mvarConculta = ""
         Me.Caption = "Diario General"
         txtCodigoDesde.Visible = False
         txtCodigoHasta.Visible = False
         DataCombo1(0).Visible = False
         DataCombo1(1).Visible = False
         lblLabels(0).Visible = False
         lblLabels(1).Visible = False
         Frame1.Visible = False
         lblLabels(2).Left = lblLabels(0).Left
         lblLabels(3).Left = lblLabels(0).Left
         DTFields(0).Left = txtCodigoDesde.Left
         DTFields(1).Left = DTFields(0).Left
         With Label3
            .Top = lblLabels(2).Top
            .Left = DTFields(0).Left + DTFields(0).Width + 100
            .Width = .Width * 3
            .Caption = "Saldo transporte inicial :"
            .Visible = True
         End With
         With Text1
            .Top = DTFields(0).Top
            .Left = Label3.Left + Label3.Width + 50
            .Width = .Width * 3
            .Text = "0"
            .Visible = True
         End With
         With Label4
            .Top = lblLabels(3).Top
            .Left = DTFields(1).Left + DTFields(1).Width + 100
            .Width = .Width * 3
            .Caption = "Nro. movimiento inicial :"
            .Visible = True
         End With
         With Text2
            .Top = DTFields(1).Top
            .Left = Label4.Left + Label4.Width + 50
            .Width = .Width * 2
            .Text = "1"
            .Visible = True
         End With
         With Label5
            .Top = Label4.Top
            .Left = Text2.Left + Text2.Width + 100
            .Width = .Width * 2.5
            .Caption = "Nro. pagina inicial :"
            .Visible = True
         End With
         With Text3
            .Top = Text2.Top
            .Left = Label5.Left + Label5.Width + 50
            .Text = "1"
            .Visible = True
         End With
         With Frame6
            .Top = Frame1.Top
            .Left = Frame1.Left
            .Visible = True
         End With
         Option12.Caption = "Resumido"
         Option13.Caption = "Detallado"
         If BuscarClaveINI("Preguntar inclusion de asientos de consolidacion") = "SI" Then
            With Check8
               .Width = cmd(0).Width * 2.5
               .Left = Me.Width - .Width - 250
               .Top = cmd(0).Top
               .Caption = "Tomar asientos de consolidacion"
               .Value = 1
               .Visible = True
            End With
         End If
'         If Me.NivelAcceso = EnumAccesos.Alto Then
'            With Check2
'               .Width = cmd(0).Width * 2.5
'               .Left = Me.Width - .Width - 250
'               .Top = cmd(0).Top + Check8.Height + 10
'               .Caption = "Cerrar fecha en parametros"
'               .Value = 0
'               .Visible = True
'            End With
'         End If
         Toolbar1.Buttons(7).Visible = True
'         mvarConculta = "ConsultaMayorResumido"
'         Me.Caption = "Informe de mayor contable resumido"
'         Set DataCombo1(0).RowSource = Aplicacion.CargarLista(DataCombo1(0).Tag)
'         Set DataCombo1(1).RowSource = Aplicacion.CargarLista(DataCombo1(0).Tag)
      
      Case 1
         mvarConculta = "ConsultaMayorDetallado"
         Me.Caption = "Informe de mayor contable"
         Set DataCombo2(0).RowSource = Aplicacion.Obras.TraerFiltrado("_TodasActivasParaCombo")
         Set DataCombo2(1).RowSource = Aplicacion.CargarLista(DataCombo2(1).Tag)
         Set DataCombo2(2).RowSource = Aplicacion.CargarLista(DataCombo2(2).Tag)
         txtProcesando.Visible = True
         Frame1.Visible = True
         With Frame5
            .Top = cmd(0).Top
            .Left = cmd(0).Left + cmd(0).Width + 200
            .Visible = False
         End With
         Option7.Value = True
         Option8.Value = True
         Option11.Value = True
         With Frame6
            .Top = Frame5.Top
            .Left = Frame5.Left + Frame5.Width + 200
            .Height = Frame5.Height
            .Caption = "Tipo informe :"
            '.Visible = True
         End With
         With Option12
            .Caption = "Detallado"
            .Value = True
         End With
         Option13.Caption = "Resumido"
         With rchObservaciones
            .Top = cmd(0).Top
            .Left = cmd(0).Left + cmd(0).Width + 200
            .Width = Me.Width * 0.4
            .Height = Frame5.Height
            .Visible = True
         End With
         If BuscarClaveINI("Preguntar inclusion de asientos de consolidacion") = "SI" Then
            With Check8
               .Width = cmd(0).Width * 2.5
               .Left = Me.Width - .Width - 250
               .Top = cmd(0).Top
               .Caption = "Tomar asientos de consolidacion"
               .Value = 1
               .Visible = True
            End With
         End If
      
      Case 2
         mvarConculta = "ConsultaBalance"
         Me.Caption = "Balance de sumas y saldos"
         txtProcesando.Visible = True
         lblLabels(4).Visible = True
         Frame1.Visible = False
         Frame2.Visible = True
         Frame5.Visible = False
         Option1.Value = True
         Option3.Value = True
         Option10.Value = True
         lblLabels(2).Left = Lista.Left
         lblLabels(3).Left = Lista.Left
         DTFields(0).Left = lblLabels(2).Left + lblLabels(2).Width + 100
         DTFields(1).Left = DTFields(0).Left
         With Check2
            .Width = DTFields(1).Width * 3
            .Left = Lista.Left + Lista.Width - .Width
            .Top = lblLabels(2).Top
            .Caption = "Tomar asientos de apertura de ejercicio :"
            .Value = 1
            .Visible = True
         End With
         With Check7
            .Width = Check2.Width
            .Left = Check2.Left
            .Top = Check2.Top + Check2.Height + 10
            .Caption = "Tomar asientos de cierre de ejercicio :"
            .Value = 1
            .Visible = True
         End With
         With Check9
            .Width = Check2.Width
            .Left = Check2.Left
            .Top = Check7.Top + Check7.Height + 10
            .Caption = "Agregar resumen por centro de costos :"
            .Value = 0
            .Visible = True
         End With
         If BuscarClaveINI("Preguntar inclusion de asientos de consolidacion") = "SI" Then
            With Check8
               .Width = cmd(0).Width * 2.5
               .Left = Me.Width - .Width - 250
               .Top = cmd(0).Top
               .Caption = "Tomar asientos de consolidacion"
               .Value = 1
               .Visible = True
            End With
         End If
         With Frame7
            .Left = Me.DTFields(0).Left + Me.DTFields(0).Width + 500
            .Top = Me.DTFields(0).Top - 100
            .Visible = True
         End With
         For i = 0 To 4: Check3(i).Value = 1: Next
      
      Case 3
         mvarConculta = ""
         Me.Caption = "Balance de sumas y saldos (con apertura)"
         txtProcesando.Visible = False
         lblLabels(4).Visible = False
         txtCodigoDesde.Visible = False
         txtCodigoHasta.Visible = False
         DataCombo1(0).Visible = False
         DataCombo1(1).Visible = False
         lblLabels(0).Visible = False
         lblLabels(1).Visible = False
         Frame1.Visible = False
         Frame5.Visible = False
         Option6.Value = True
         Option10.Value = True
         lblLabels(2).Left = Lista.Left
         DTFields(0).Left = lblLabels(2).Left + lblLabels(2).Width + 100
         With lblLabels(3)
            .Left = DTFields(0).Left + DTFields(0).Width * 1.5
            .Top = lblLabels(2).Top
         End With
         With DTFields(1)
            .Left = lblLabels(3).Left + lblLabels(3).Width + 100
            .Top = DTFields(0).Top
         End With
'         With Lista
'            .Top = lblLabels(1).Top
'            .Height = .Height * 1.05
'         End With
         Lista.Visible = False
         Me.Height = Me.Height / 3
         cmd(0).Top = Lista.Top
         With cmd(1)
            .Top = Lista.Top
            .Left = cmd(0).Width + 10
         End With
         With Label1
            .Top = DTFields(0).Top + (DTFields(0).Height * 1.5)
            .Left = Lista.Width / 3
            .Width = Lista.Width * 2 / 3
         End With
         With Check2
            .Width = DTFields(1).Width * 3
            .Left = Lista.Left + Lista.Width - .Width
            .Top = lblLabels(2).Top
            .Caption = "Tomar asientos de apertura de ejercicio :"
            .Value = 1
            .Visible = True
         End With
         With Check7
            .Width = Check2.Width
            .Left = Check2.Left
            .Top = Check2.Top + Check2.Height + 10
            .Caption = "Tomar asientos de cierre de ejercicio :"
            .Value = 1
            .Visible = True
         End With
         If BuscarClaveINI("Preguntar inclusion de asientos de consolidacion") = "SI" Then
            With Check8
               .Width = Check2.Width
               .Left = Check2.Left
               .Top = Check2.Top + Check2.Height + 10
               .Caption = "Tomar asientos de consolidacion"
               .Value = 1
               .Visible = True
            End With
         End If
      
      Case 4
         mvarConculta = ""
         Me.Caption = "Resumen por rubros contables"
         Option1.Value = True
         DataCombo1(0).Visible = False
         DataCombo1(1).Visible = False
         txtCodigoDesde.Visible = False
         txtCodigoHasta.Visible = False
         lblLabels(2).Visible = False
         lblLabels(3).Visible = False
         DTFields(0).Visible = False
         DTFields(1).Visible = False
         Frame1.Visible = False
         With lblLabels(0)
            .Caption = "Mes a procesar :"
            .Visible = True
         End With
         With lblLabels(1)
            .Caption = "Año :"
            .Visible = True
         End With
         With Combo1
            .Left = txtCodigoDesde.Left
            .Top = txtCodigoDesde.Top
            .Width = 1500
            .Visible = True
            .ListIndex = Month(DateAdd("m", -1, Date)) - 1
         End With
         With txtAnio
            .Left = txtCodigoHasta.Left
            .Top = txtCodigoHasta.Top
            .Visible = True
            .Text = Year(DateAdd("m", -1, Date))
         End With
      
      Case 5
         mvarConculta = ""
         Me.Caption = "Presupuesto economico por cuenta"
         txtProcesando.Visible = False
         lblLabels(4).Visible = False
         txtCodigoDesde.Visible = False
         txtCodigoHasta.Visible = False
         DataCombo1(1).Visible = False
         lblLabels(0).Visible = False
         lblLabels(1).Visible = False
         lblLabels(3).Visible = False
         Frame1.Visible = False
         DTFields(0).Visible = False
         DTFields(1).Visible = False
         Lista.Visible = False
         Option6.Value = True
         With lblLabels(2)
            .Left = cmd(0).Left
            .Caption = "Ejercicio :"
         End With
         With DataCombo1(0)
            .Top = lblLabels(2).Top - 50
            .Left = lblLabels(2).Left + lblLabels(2).Width + 100
            .BoundColumn = "IdEjercicioContable"
            Set .RowSource = Aplicacion.EjerciciosContables.TraerLista
            .TabIndex = 0
            .Visible = True
         End With
         Me.Height = Me.Height / 2.4
         Me.Width = Me.Width / 2
         With Label1
            .Top = lblLabels(2).Top + lblLabels(2).Height + 100
            .Left = Lista.Left
            .Visible = True
         End With
         cmd(0).Top = Label1.Top + Label1.Height + 100
         With cmd(1)
            .Top = cmd(0).Top
            .Left = cmd(0).Width + 10
         End With
         With Check2
            .Width = DTFields(1).Width * 2.55
            .Left = cmd(1).Left + cmd(1).Width + 100
            .Top = cmd(0).Top
            .Caption = "Presupuesto resumido x cuenta madre :"
            .Value = 0
            .Visible = True
         End With
         With Check7
            .Width = Check2.Width
            .Left = Check2.Left
            .Top = Check2.Top + Check2.Height + 10
            .Caption = "Tomar asientos de cierre de ejercicio :"
            .Value = 1
            .Visible = True
         End With
      
      Case 17
         mvarConculta = ""
         Me.Caption = "Diario General IGJ"
         txtCodigoDesde.Visible = False
         txtCodigoHasta.Visible = False
         DataCombo1(0).Visible = False
         DataCombo1(1).Visible = False
         lblLabels(0).Visible = False
         lblLabels(1).Visible = False
         Frame1.Visible = False
         lblLabels(2).Left = lblLabels(0).Left
         lblLabels(3).Left = lblLabels(0).Left
         DTFields(0).Left = txtCodigoDesde.Left
         DTFields(1).Left = DTFields(0).Left
         With Label3
            .Top = lblLabels(2).Top
            .Left = DTFields(0).Left + DTFields(0).Width + 100
            .Width = .Width * 3
            .Caption = "Saldo transporte inicial :"
            .Visible = True
         End With
         With Text1
            .Top = DTFields(0).Top
            .Left = Label3.Left + Label3.Width + 50
            .Width = .Width * 3
            .Text = "0"
            .Visible = True
         End With
         With Label4
            .Top = lblLabels(3).Top
            .Left = DTFields(1).Left + DTFields(1).Width + 100
            .Width = .Width * 3
            .Caption = "Nro. movimiento inicial :"
            .Visible = True
         End With
         With Text2
            .Top = DTFields(1).Top
            .Left = Label4.Left + Label4.Width + 50
            .Width = .Width * 2
            .Text = "1"
            .Visible = True
         End With
         With Label5
            .Top = Label4.Top
            .Left = Text2.Left + Text2.Width + 100
            .Width = .Width * 2.5
            .Caption = "Nro. pagina inicial :"
            .Visible = True
         End With
         With Text3
            .Top = Text2.Top
            .Left = Label5.Left + Label5.Width + 50
            .Text = "1"
            .Visible = True
         End With
         With Frame6
            .Top = Frame1.Top
            .Left = Frame1.Left
            .Visible = True
         End With
         Option12.Caption = "Resumido"
         Option13.Caption = "Detallado"
         If BuscarClaveINI("Preguntar inclusion de asientos de consolidacion") = "SI" Then
            With Check8
               .Width = cmd(0).Width * 2.5
               .Left = Me.Width - .Width - 250
               .Top = cmd(0).Top
               .Caption = "Tomar asientos de consolidacion"
               .Value = 1
               .Visible = True
            End With
         End If
         Toolbar1.Buttons(9).Visible = True
      
      Case 101
         mvarConculta = ""
         mvarValidate = False
         Me.Caption = "Resumen de compras por proveedor"
         DataCombo1(0).Visible = False
         DataCombo1(1).Visible = False
         Frame1.Visible = False
         lblLabels(4).Visible = False
         Option1.Value = True
         lblLabels(0).Caption = "Desde prov.:"
         lblLabels(1).Caption = "Hasta prov.:"
         lblLabels(2).Left = DataCombo1(0).Left
         lblLabels(3).Left = DataCombo1(0).Left
         DTFields(0).Left = lblLabels(2).Left + lblLabels(2).Width + 10
         DTFields(1).Left = DTFields(0).Left
         txtCodigoHasta.Text = "ZZ9999"
      
      Case 201
         mvarConculta = ""
         mvarValidate = False
         Me.Caption = "Resumen de ventas por cliente"
         DataCombo1(0).Visible = False
         DataCombo1(1).Visible = False
         Frame1.Visible = False
         lblLabels(4).Visible = False
         Option1.Value = True
         lblLabels(0).Caption = "Desde cliente:"
         lblLabels(1).Caption = "Hasta cliente:"
         lblLabels(2).Left = DataCombo1(0).Left
         lblLabels(3).Left = DataCombo1(0).Left
         DTFields(0).Left = lblLabels(2).Left + lblLabels(2).Width + 10
         DTFields(1).Left = DTFields(0).Left
         txtCodigoHasta.Text = "ZZ9999"
      
      Case Else
         Me.Hide
   End Select
   
End Property

Private Sub Check1_Click()

   If Check1.Value = 0 Then
      Dim mIdCuenta As Long
      With DataCombo2(1)
         .BoundText = 0
         .Text = ""
      End With
      txtCodigoCuenta.Enabled = True
      mIdCuenta = 0
      With DataCombo2(3)
         If IsNumeric(.BoundText) Then mIdCuenta = .BoundText
         Set .RowSource = Aplicacion.Cuentas.TraerLista
         .BoundText = mIdCuenta
         .Enabled = True
      End With
      With DataCombo2(2)
         .BoundText = 0
         .Enabled = True
      End With
   End If
   
End Sub

Private Sub cmd_Click(Index As Integer)

   On Error GoTo Mal
         
   Select Case Index
      Case 0
         If Frame4.Visible And Len(txtCodigoCuenta.Text) = 0 Then
            MsgBox "Debe definir la cuenta", vbExclamation
            Exit Sub
         End If
         
         Dim oAp As ComPronto.Aplicacion
'         Dim dsoServer As DSO.Server
'         Dim dsoDatabase As DSO.Database
'         Dim oPackage As DTS.Package2
         Dim oRs As ADOR.Recordset
         Dim oRsCuentas As ADOR.Recordset
         Dim oRsIni As ADOR.Recordset
         Dim oRsMov As ADOR.Recordset
         Dim oRsMayor As ADOR.Recordset
         Dim mvarPrimero As Boolean, mvarEmite As Boolean
         Dim mvarCuenta As Long, mCuentaDesde As Long, mCuentaHasta As Long, mIdObra As Long
         Dim i As Long, mvarNivel As Integer, mvarEjercicioInicio As Integer
         Dim mAuxI1 As Integer
         Dim mvarSaldo As Double, mvarSaldoInicial(9) As Double
         Dim mvarSaldoDebe(9) As Double, mvarSaldoHaber(9) As Double
         Dim mvarSaldoInicial1 As Double, mvarSaldoDebe1 As Double
         Dim mvarSaldoHaber1 As Double
         Dim Vector_X As String, Vector_T As String, Vector_E As String
         Dim mvarNivelDetalle As String, mIni As String, mIncluirCierre As String
         Dim mvarAuxS1 As String, mvarAuxS2 As String, mvarAuxS3 As String, mvarAuxS4 As String
         Dim mIncluirApertura As String, mIncluirConsolidacion As String
         Dim mDescripcionDesde As String, mDescripcionHasta As String
         Dim mvarFechaEjercicioInicial As Date
         
         If Option1.Value Then
            mCuentaDesde = 0
            mCuentaHasta = 999999999
         ElseIf Frame4.Visible Then
            mCuentaDesde = Val(txtCodigoCuenta.Text)
            mCuentaHasta = Val(txtCodigoCuenta.Text)
            mDescripcionDesde = DataCombo2(3).Text
            mDescripcionHasta = DataCombo2(3).Text
         Else
            mCuentaDesde = Val(txtCodigoDesde.Text)
            mCuentaHasta = Val(txtCodigoHasta.Text)
            mDescripcionDesde = DataCombo1(0).Text
            mDescripcionHasta = DataCombo1(1).Text
         End If
         
         Select Case mvarCodigoInforme
            Case 0
               If Len(Text1.Text) = 0 Or Not IsNumeric(Text1.Text) Then
                  MsgBox "Debe indicar el saldo inicial", vbInformation
                  Exit Sub
               End If
               
               If Len(Text2.Text) = 0 Or Not IsNumeric(Text2.Text) Then
                  MsgBox "Debe indicar el numero de movimiento inicial", vbInformation
                  Exit Sub
               End If
               
               If Len(Text3.Text) = 0 Or Not IsNumeric(Text3.Text) Then
                  MsgBox "Debe indicar el numero de pagina inicial", vbInformation
                  Exit Sub
               End If
               
               If Not Option12.Value And Not Option13.Value Then
                  MsgBox "Debe indicar si el diario se emite resumido o detallado", vbInformation
                  Exit Sub
               End If
               
               Me.MousePointer = vbHourglass
               
               mIncluirConsolidacion = "SI"
               If Check8.Visible And Check8.Value = 0 Then mIncluirConsolidacion = "NO"
               
               Text1.Enabled = False
               If Option12.Value Then
                  mIni = BuscarClaveINI("ModeloDiarioResumido")
                  Set oRs = CopiarTodosLosRegistros(Aplicacion.TablasGenerales.TraerFiltrado("InformeDeDiario", _
                              "_2_Resumido" & mIni, _
                              Array(DTFields(0).Value, DTFields(1).Value, _
                                    Val(Text1.Text), mIncluirConsolidacion)))
               Else
                  If Frame8.Visible Then
                     mvarAuxS3 = ""
                     If Check4.Value = 1 Then
                        mvarAuxS3 = mvarAuxS3 & "S"
                     Else
                        mvarAuxS3 = mvarAuxS3 & "N"
                     End If
                     If Check5.Value = 1 Then
                        mvarAuxS3 = mvarAuxS3 & "S"
                     Else
                        mvarAuxS3 = mvarAuxS3 & "N"
                     End If
                     If Check6.Value = 1 Then
                        mvarAuxS3 = mvarAuxS3 & "S"
                     Else
                        mvarAuxS3 = mvarAuxS3 & "N"
                     End If
                  Else
                     mvarAuxS3 = "NNN"
                  End If
                  mIni = BuscarClaveINI("ModeloDiarioDetallado")
                  Set oRs = CopiarTodosLosRegistros(Aplicacion.TablasGenerales.TraerFiltrado("InformeDeDiario", _
                              "_2" & mIni, _
                              Array(DTFields(0).Value, DTFields(1).Value, _
                                    Val(Text1.Text), mvarAuxS3, mIncluirConsolidacion)))
               End If
               mvarPrimero = True
               mAuxI1 = 0
               With oRs
                  If .RecordCount > 0 And mIni <> "_Modelo_IGJ" Then
                     .MoveFirst
                     i = CLng(Text2.Text)
                     Do While Not .EOF
                        If mIni = "_Modelo3" And .Fields("K_Orden").Value = 1 Then
                           .Fields("NOMBRE DE LA CUENTA").Value = .Fields("NOMBRE DE LA CUENTA").Value & " " & Format(i, "0000000000")
                           i = i + 1
                           .Update
                        ElseIf mIni = "_Modelo4" And .Fields("K_Orden").Value = 1 Then
                           If mvarPrimero Then
                              .Fields("Asiento").Value = i
                              i = i + 1
                              mvarPrimero = False
                           Else
                              .Fields("Asiento").Value = Null
                           End If
                           .Update
                        ElseIf .Fields("K_Orden").Value = 1 Then
                           .Fields("Numero").Value = i
                           i = i + 1
                           .Update
                        End If
                        If .Fields("K_Orden").Value = 2 Then mvarPrimero = True
                        .MoveNext
                     Loop
                     .MoveFirst
                  End If
               End With
               Lista.Sorted = False
               Set Lista.DataSource = oRs
               Set oRs = Nothing
               
               mvarSubTituloExcel = "|Desde el " & DTFields(0).Value & " al " & DTFields(1).Value
            
            Case 1
               Me.MousePointer = vbHourglass
         
               Lista.ListItems.Clear
               mvarPrimero = True
               
               mvarAuxS1 = BuscarClaveINI("Detalle de cuentas hijas en mayor")
               If Len(mvarAuxS1) = 0 Then mvarAuxS1 = "SI"
               
               mvarAuxS2 = BuscarClaveINI("Detalle sin agrupar en mayor")
               If Len(mvarAuxS2) = 0 Then mvarAuxS2 = "NO"
               
               mIncluirConsolidacion = "SI"
               If Check8.Visible And Check8.Value = 0 Then mIncluirConsolidacion = "NO"
               
               mIdObra = -1
               mvarAuxS4 = ""
               If IsNumeric(DataCombo2(0).BoundText) Then
                  mIdObra = DataCombo2(0).BoundText
                  mvarAuxS4 = "|" & DataCombo2(0).Text
               End If
               
               Set oAp = Aplicacion
               Set oRsCuentas = oAp.TablasGenerales.TraerFiltrado("Cuentas", "_DesdeHasta", _
                                    Array(mCuentaDesde, mCuentaHasta, DTFields(1).Value))
               
               If oRsCuentas.RecordCount > 0 Then
                  oRsCuentas.MoveFirst
                  Do While Not oRsCuentas.EOF
                     txtProcesando.Text = oRsCuentas.Fields("Codigo").Value & " " & oRsCuentas.Fields("Descripcion").Value
                     DoEvents
                     
                     mvarCuenta = oRsCuentas.Fields("IdCuenta").Value
                     mvarSaldo = 0
                     mvarEmite = False
                     
                     If oRsCuentas.Fields("IdTipoCuenta").Value = 2 Then
                        Set oRsMov = oAp.TablasGenerales.TraerFiltrado("InformeMayorDetallado", "_1", _
                              Array(mvarCuenta, DTFields(0).Value, DTFields(1).Value, _
                                    mvarAuxS1, mvarAuxS2, mIncluirConsolidacion, mIdObra))
                        If oRsMov.RecordCount > 0 Then
                           If mvarPrimero Then
                              Set oRsMayor = CopiarEstructura(oRsMov)
                              mvarPrimero = False
                           End If
                           With oRsMayor
                              If oRsMov.RecordCount > 0 Then
                                 oRsMov.MoveFirst
                                 Do While Not oRsMov.EOF
                                    .AddNew
                                    For i = 0 To oRsMov.Fields.Count - 1
                                       .Fields(i).Value = oRsMov.Fields(i).Value
                                    Next
                                    rchObservaciones.TextRTF = IIf(IsNull(.Fields("Observaciones").Value), "", .Fields("Observaciones").Value)
                                    .Fields("Observaciones").Value = rchObservaciones.Text
                                    .Update
                                    oRsMov.MoveNext
                                 Loop
                              End If
                           End With
                        End If
                        oRsMov.Close
                     End If
                     oRsCuentas.MoveNext
                  Loop
               End If
               
               oRsCuentas.Close
               
               Set oRsCuentas = Nothing
               Set oRsMov = Nothing
               Set oRsIni = Nothing
               
               If Not oRsMayor Is Nothing Then
                  If oRsMayor.RecordCount > 0 Then
                     oRsMayor.MoveFirst
                     Lista.Sorted = False
                     Set Lista.DataSource = oRsMayor
                  End If
               End If
               
               Set oRsMayor = Nothing
               Set oAp = Nothing
         
               mvarSubTituloExcel = "|Desde el " & DTFields(0).Value & " al " & DTFields(1).Value & mvarAuxS4
               If Option1.Value Then
                  mvarSubTituloExcel = mvarSubTituloExcel & "|Todas las cuentas"
               ElseIf Frame4.Visible Then
                  mvarSubTituloExcel = mvarSubTituloExcel & "|Cuenta " & "[" & mCuentaDesde & "] " & mDescripcionDesde
               Else
                  mvarSubTituloExcel = mvarSubTituloExcel & "|Desde la cuenta " & "[" & mCuentaDesde & "] " & mDescripcionDesde & " " & _
                              "a la cuenta [" & mCuentaHasta & "] " & mDescripcionHasta
               End If
               
            Case 2
               Me.MousePointer = vbHourglass
         
               Set oRs = ArmarBalanceIndentado
               If oRs.RecordCount > 0 Then
                  oRs.MoveFirst
                  Lista.Sorted = False
                  Set Lista.DataSource = oRs
               End If
               Set oRs = Nothing
         
               mvarSubTituloExcel = "|Desde el " & DTFields(0).Value & " al " & DTFields(1).Value
               If Option1.Value Then
                  mvarSubTituloExcel = mvarSubTituloExcel & "|Todas las cuentas"
               Else
                  mvarSubTituloExcel = mvarSubTituloExcel & "|Desde la cuenta " & mCuentaDesde & " a la cuenta " & mCuentaHasta
               End If
            
            Case 3
               Me.MousePointer = vbHourglass
         
               Label1.Visible = True

               If Option5.Value Then
                  mvarNivelDetalle = "Cuenta"
               Else
                  mvarNivelDetalle = "Comprobante"
               End If
               
               mIncluirCierre = "NO"
               If Check7.Value = 1 Then mIncluirCierre = "SI"
               mIncluirApertura = "NO"
               If Check2.Value = 1 Then mIncluirApertura = "SI"
               mIncluirConsolidacion = "SI"
               If Check8.Visible And Check8.Value = 0 Then mIncluirConsolidacion = "NO"
               
               Label1.Caption = "Comenzando calculo de balance ..."
               DoEvents
               
               Lista.Sorted = False
               mvarFechaEjercicioInicial = Aplicacion.Cuentas.FechaEjercicioInicial(DTFields(0).Value)
               mvarEjercicioInicio = Aplicacion.Cuentas.EjercicioInicial(DTFields(0).Value)
               If mvarNivelDetalle = "Cuenta" Then
                  Set Lista.DataSource = Aplicacion.Cuentas.TraerFiltrado("_BalanceConAperturaResumen", _
                           Array(mCuentaDesde, mCuentaHasta, DTFields(0).Value, DTFields(1).Value, _
                                 mvarEjercicioInicio - 1, mvarFechaEjercicioInicial, mIncluirCierre, _
                                 mIncluirApertura, mIncluirConsolidacion))
                  ExportarBalanceAExcel Lista, mvarNivelDetalle
               Else
                  Label1.Caption = Label1.Caption & vbCrLf & "Generando cubo de comprobantes ..."
                  DoEvents
                  Aplicacion.Tarea "Cuentas_TX_BalanceConAperturaParaCubo", _
                     Array(mCuentaDesde, mCuentaHasta, DTFields(0).Value, _
                           DTFields(1).Value, mvarEjercicioInicio - 1, _
                           mvarFechaEjercicioInicial, _
                           glbDtsExec & " /F " & mvarDirectorioDTS & "CuboBalance_" & glbEmpresaSegunString & "." & glbDtsExt, _
                           mIncluirCierre, mIncluirApertura, mIncluirConsolidacion)
                  
                  'Con DSO
'                  Set dsoServer = New DSO.Server
'                  dsoServer.Connect gblHOST
'                  Set dsoDatabase = dsoServer.MDStores.Item(glbEmpresaSegunString)
'                  dsoDatabase.MDStores.Item("Balance").Process processFull
'                  Set dsoDatabase = Nothing
'                  Set dsoServer = Nothing
                  
                  'Con DTS Package
'                  Set oPackage = New DTS.Package2
'                  oPackage.LoadFromSQLServer gblHOST, "", "", DTSSQLStgFlag_UseTrustedConnection, , , , "CuboBalance_" & glbEmpresaSegunString
'                  oPackage.Execute
'                  Set oPackage = Nothing
                  
                  Label1.Caption = Label1.Caption & vbCrLf & "Armando balance ..."
                  DoEvents
                  AbrirCuboBalanceEnExcel
               End If
               Me.Hide
               
               mvarSubTituloExcel = "|Desde el " & DTFields(0).Value & " al " & DTFields(1).Value
               If Option1.Value Then
                  mvarSubTituloExcel = mvarSubTituloExcel & "|Todas las cuentas"
               Else
                  mvarSubTituloExcel = mvarSubTituloExcel & "|Desde la cuenta " & mCuentaDesde & " a la cuenta " & mCuentaHasta
               End If
            
            Case 4
               Me.MousePointer = vbHourglass
         
               Dim mFecha As Date
               mFecha = DateSerial(txtAnio.Text, Combo1.ListIndex + 1, 1)
               mFecha = DateAdd("m", 1, mFecha)
               mFecha = DateAdd("d", -1, mFecha)
               Lista.Sorted = False
               Set Lista.DataSource = Aplicacion.Cuentas.TraerFiltrado("_PorRubrosContables", mFecha)
               
               mvarSubTituloExcel = "|Correspondiente a " & Combo1.Text & " del " & txtAnio.Text
            
            Case 5
               If Not IsNumeric(DataCombo1(0).BoundText) Then
                  MsgBox "Exprese el ejercicio contable", vbExclamation
                  Exit Sub
               End If
               
               Me.MousePointer = vbHourglass
         
               Label1.Visible = True
               Label1.Caption = "Comenzando calculo de presupuesto ..."
               Label1.Caption = Label1.Caption & vbCrLf & "Generando cubo de comprobantes ..."
               DoEvents
               
               mIncluirCierre = "NO"
               If Check7.Value = 1 Then mIncluirCierre = "SI"
               
               If Check2.Value = 0 Then
                  Aplicacion.Tarea "Cuentas_TX_PresupuestoEconomicoParaCubo", Array(DataCombo1(0).BoundText, _
                     glbDtsExec & " /F " & mvarDirectorioDTS & "CuboPresupuestoEconomico_" & glbEmpresaSegunString & "." & glbDtsExt, mIncluirCierre)
               Else
                  Aplicacion.Tarea "Cuentas_TX_PresupuestoEconomicoResumidoParaCubo", Array(DataCombo1(0).BoundText, _
                     glbDtsExec & " /F " & mvarDirectorioDTS & "CuboPresupuestoEconomico_" & glbEmpresaSegunString & "." & glbDtsExt, mIncluirCierre)
               End If
               
               Set oRs = Aplicacion.TablasGenerales.TraerFiltrado("Cubos", "_ControlarContenidoDeDatos", "_TempCuboPresupuestoEconomico")
               If oRs.RecordCount = 0 Then
                  MsgBox "No hay informacion para procesar", vbExclamation
                  oRs.Close
                  Set oRs = Nothing
                  Unload Me
                  Exit Sub
               End If
               oRs.Close
               Set oRs = Nothing
               
               'Con DSO
'               Set dsoServer = New DSO.Server
'               dsoServer.Connect gblHOST
'               Set dsoDatabase = dsoServer.MDStores.Item(glbEmpresaSegunString)
'               dsoDatabase.MDStores.Item("PresupuestoEconomico").Process processFull
'               Set dsoDatabase = Nothing
'               Set dsoServer = Nothing
               
               'Con DTS Package
'               Set oPackage = New DTS.Package2
'               oPackage.LoadFromSQLServer gblHOST, "", "", DTSSQLStgFlag_UseTrustedConnection, , , , "CuboPresupuestoEconomico_" & glbEmpresaSegunString
'               oPackage.Execute
'               Set oPackage = Nothing
               
               Label1.Caption = Label1.Caption & vbCrLf & "Armando informe ..."
               DoEvents
               AbrirCuboPresupuestoEconomicoEnExcel
               Me.Hide
               
            Case 17
               If Len(Text1.Text) = 0 Or Not IsNumeric(Text1.Text) Then
                  MsgBox "Debe indicar el saldo inicial", vbInformation
                  Exit Sub
               End If
               
               If Len(Text2.Text) = 0 Or Not IsNumeric(Text2.Text) Then
                  MsgBox "Debe indicar el numero de movimiento inicial", vbInformation
                  Exit Sub
               End If
               
               If Len(Text3.Text) = 0 Or Not IsNumeric(Text3.Text) Then
                  MsgBox "Debe indicar el numero de pagina inicial", vbInformation
                  Exit Sub
               End If
               
               If Not Option12.Value And Not Option13.Value Then
                  MsgBox "Debe indicar si el diario se emite resumido o detallado", vbInformation
                  Exit Sub
               End If
               
               Me.MousePointer = vbHourglass
               
               mIncluirConsolidacion = "SI"
               If Check8.Visible And Check8.Value = 0 Then mIncluirConsolidacion = "NO"
               
               Text1.Enabled = False
               If Option12.Value Then
                  mIni = BuscarClaveINI("ModeloDiarioResumido")
                  Set oRs = CopiarTodosLosRegistros(Aplicacion.TablasGenerales.TraerFiltrado("InformeDeDiario", _
                              "_2_Resumido" & mIni, _
                              Array(DTFields(0).Value, DTFields(1).Value, _
                                    Val(Text1.Text), mIncluirConsolidacion)))
               Else
                  If Frame8.Visible Then
                     mvarAuxS3 = ""
                     If Check4.Value = 1 Then
                        mvarAuxS3 = mvarAuxS3 & "S"
                     Else
                        mvarAuxS3 = mvarAuxS3 & "N"
                     End If
                     If Check5.Value = 1 Then
                        mvarAuxS3 = mvarAuxS3 & "S"
                     Else
                        mvarAuxS3 = mvarAuxS3 & "N"
                     End If
                     If Check6.Value = 1 Then
                        mvarAuxS3 = mvarAuxS3 & "S"
                     Else
                        mvarAuxS3 = mvarAuxS3 & "N"
                     End If
                  Else
                     mvarAuxS3 = "NNN"
                  End If
                  mIni = BuscarClaveINI("ModeloDiarioDetallado")
                  Set oRs = CopiarTodosLosRegistros(Aplicacion.TablasGenerales.TraerFiltrado("InformeDeDiario", _
                              "_2" & mIni, _
                              Array(DTFields(0).Value, DTFields(1).Value, _
                                    Val(Text1.Text), mvarAuxS3, mIncluirConsolidacion)))
               End If
               mvarPrimero = True
               mAuxI1 = 0
               With oRs
                  If .RecordCount > 0 And mIni <> "_Modelo_IGJ" Then
                     .MoveFirst
                     i = CLng(Text2.Text)
                     Do While Not .EOF
                        If mIni = "_Modelo3" And .Fields("K_Orden").Value = 1 Then
                           .Fields("NOMBRE DE LA CUENTA").Value = .Fields("NOMBRE DE LA CUENTA").Value & " " & Format(i, "0000000000")
                           i = i + 1
                           .Update
                        ElseIf mIni = "_Modelo4" And .Fields("K_Orden").Value = 1 Then
                           If mvarPrimero Then
                              .Fields("Asiento").Value = i
                              i = i + 1
                              mvarPrimero = False
                           Else
                              .Fields("Asiento").Value = Null
                           End If
                           .Update
                        ElseIf .Fields("K_Orden").Value = 1 Then
                           .Fields("Numero").Value = i
                           i = i + 1
                           .Update
                        End If
                        If .Fields("K_Orden").Value = 2 Then mvarPrimero = True
                        .MoveNext
                     Loop
                     .MoveFirst
                  End If
               End With
               Lista.Sorted = False
               Set Lista.DataSource = oRs
               Set oRs = Nothing
               
               mvarSubTituloExcel = "|Desde el " & DTFields(0).Value & " al " & DTFields(1).Value
            
            Case 101
               Me.MousePointer = vbHourglass
         
               Lista.Sorted = False
               Set Lista.DataSource = Aplicacion.Proveedores.TraerFiltrado("_ResumenCompras", Array(DTFields(0).Value, DTFields(1).Value, txtCodigoDesde.Text, txtCodigoHasta.Text))
         
               mvarSubTituloExcel = "|Desde el " & DTFields(0).Value & " al " & DTFields(1).Value
               If Option1.Value Then
                  mvarSubTituloExcel = mvarSubTituloExcel & "|Todas las cuentas"
               Else
                  mvarSubTituloExcel = mvarSubTituloExcel & "|Desde la cuenta " & mCuentaDesde & " a la cuenta " & mCuentaHasta
               End If
            
            Case 201
               Me.MousePointer = vbHourglass
         
               Lista.Sorted = False
               Set Lista.DataSource = Aplicacion.Clientes.TraerFiltrado("_ResumenVentas", Array(DTFields(0).Value, DTFields(1).Value, txtCodigoDesde.Text, txtCodigoHasta.Text))
         
               mvarSubTituloExcel = "|Desde el " & DTFields(0).Value & " al " & DTFields(1).Value
               If Option1.Value Then
                  mvarSubTituloExcel = mvarSubTituloExcel & "|Todas las cuentas"
               Else
                  mvarSubTituloExcel = mvarSubTituloExcel & "|Desde la cuenta " & mCuentaDesde & " a la cuenta " & mCuentaHasta
               End If
            
         End Select
         
         Lista.Refresh
         
         StatusBar1.Panels(2).Text = "" & Lista.ListItems.Count & " elementos en la lista"
         
         Me.MousePointer = vbDefault
      
      Case 1
         
         Me.Hide
      
   End Select
   
Salida:

   Set oAp = Nothing
'   Set dsoServer = Nothing
'   Set dsoDatabase = Nothing
'   Set oPackage = Nothing
   Set oRsCuentas = Nothing
   Set oRsIni = Nothing
   Set oRsMov = Nothing
   Set oRsMayor = Nothing
   
   Exit Sub
   
Mal:

   Select Case Err.Number
      Case Else
         MsgBox "Se ha producido un error al procesar los datos" & vbCrLf & Err.Number & " -> " & Err.Description, vbCritical
   End Select
   Resume Salida

End Sub

Private Sub DataCombo1_KeyPress(Index As Integer, KeyAscii As Integer)

   If KeyAscii = Asc(vbCr) Then SendKeys "{TAB}", True

End Sub

Private Sub DataCombo1_Validate(Index As Integer, Cancel As Boolean)

   If IsNumeric(DataCombo1(Index).BoundText) And mvarCodigoInforme <> 5 Then
      Dim oRs As ADOR.Recordset
      Dim mvarCodigo As String
      Set oRs = Aplicacion.Cuentas.TraerFiltrado("_PorIdConDatos", Array(DataCombo1(Index).BoundText, DTFields(1).Value))
      mvarCodigo = IIf(IsNull(oRs.Fields("Codigo1").Value), 0, oRs.Fields("Codigo1").Value)
      oRs.Close
      Set oRs = Nothing
      Select Case Index
         Case 0
            txtCodigoDesde.Text = mvarCodigo
         Case 1
            txtCodigoHasta.Text = mvarCodigo
      End Select
   End If

End Sub

Private Sub DataCombo2_Change(Index As Integer)

   If IsNumeric(DataCombo2(Index).BoundText) Then
      Dim mClave As Long
      Select Case Index
         Case 0
            mClave = 0
            If IsNumeric(DataCombo2(1).BoundText) Then mClave = DataCombo2(1).BoundText
            Set DataCombo2(1).RowSource = Aplicacion.Cuentas.TraerFiltrado("_CuentasGastoPorObraParaCombo", DataCombo2(Index).BoundText)
            DataCombo2(1).BoundText = mClave
         Case 3
            Dim oRs As ADOR.Recordset
            Set oRs = Aplicacion.Cuentas.TraerFiltrado("_PorIdConDatos", Array(DataCombo2(3).BoundText, DTFields(1).Value))
            If oRs.RecordCount > 0 Then txtCodigoCuenta.Text = oRs.Fields("Codigo1").Value
            oRs.Close
            If DataCombo2(Index).Visible And Len(Trim(DataCombo2(Index).BoundText)) > 0 Then
               Set oRs = Aplicacion.Cuentas.TraerFiltrado("_CuentasDependientesPorIdCuenta", DataCombo2(3).BoundText)
               If oRs.RecordCount > 0 Then
                  With Label2
                     .Caption = "Cuenta con dependencias"
                     .Visible = True
                  End With
               Else
                  Label2.Visible = False
               End If
               oRs.Close
            End If
            Set oRs = Nothing
      End Select
   End If

End Sub

Private Sub DataCombo2_Click(Index As Integer, Area As Integer)

   SetDataComboDropdownListWidth 400

   If IsNumeric(DataCombo2(Index).BoundText) Then
      Dim oRs As ADOR.Recordset
      Dim mIdCuenta As Long
      Select Case Index
         Case 0
            If Not DataCombo2(1).Enabled Then DataCombo2(1).Enabled = True
         Case 1
            If DataCombo2(1).Enabled Then
               If Not IsNumeric(DataCombo2(0).BoundText) Then
                  MsgBox "Debe definir la obra", vbExclamation
                  With DataCombo2(1)
                     .BoundText = 0
                     .Text = ""
                  End With
                  Exit Sub
               End If
               Set oRs = Aplicacion.Cuentas.TraerFiltrado("_PorObraCuentaGasto", _
                     Array(DataCombo2(0).BoundText, DataCombo2(1).BoundText))
               If oRs.RecordCount > 0 Then
                  If Len(DataCombo2(2).Text) > 0 Then
                     With DataCombo2(2)
                        .BoundText = 0
                        .Text = ""
                     End With
                     If glbSeñal1 Then
                        Set DataCombo2(3).RowSource = Aplicacion.Cuentas.TraerFiltrado("_PorFechaParaCombo", DTFields(1).Value)
                     Else
                        Set DataCombo2(3).RowSource = Aplicacion.Cuentas.TraerLista
                     End If
                  End If
                  DataCombo2(3).BoundText = oRs.Fields("IdCuenta").Value
               End If
               oRs.Close
               Set oRs = Nothing
            Else
               With DataCombo2(1)
                  .BoundText = 0
                  .Text = ""
               End With
            End If
            txtCodigoCuenta.Enabled = False
            DataCombo2(3).Enabled = False
            DataCombo2(2).Enabled = False
            Check1.Value = 1
         Case 2
            If IsNumeric(DataCombo2(3).BoundText) Then
               mIdCuenta = DataCombo2(3).BoundText
            Else
               mIdCuenta = 0
            End If
            Set oRs = Aplicacion.Cuentas.TraerFiltrado("_PorGrupoParaCombo", Array(DataCombo2(2).BoundText, DTFields(1).Value))
            Set DataCombo2(3).RowSource = oRs
            DataCombo2(3).BoundText = mIdCuenta
            If Len(DataCombo2(3).Text) = 0 Then txtCodigoCuenta.Text = ""
            Set oRs = Nothing
      End Select
   End If

End Sub

Private Sub DTFields_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)

   If KeyCode = vbKeyReturn Then PostMessage DTFields(Index).hwnd, WM_KEYDOWN, VK_TAB, 0

End Sub

Private Sub DTFields_Validate(Index As Integer, Cancel As Boolean)

   If glbSeñal1 And Index = 1 Then
      Dim mIdAux As Long
      Dim oRs As ADOR.Recordset
      If Option2.Value Then
         If Option10.Value Then
            mIdAux = 0
            If IsNumeric(DataCombo1(0).BoundText) Then mIdAux = DataCombo1(0).BoundText
            Set DataCombo1(0).RowSource = Aplicacion.Cuentas.TraerFiltrado("_PorCodigoDescripcionParaCombo", DTFields(1).Value)
            DataCombo1(0).BoundText = mIdAux
            Set oRs = Aplicacion.Cuentas.TraerFiltrado("_PorIdConDatos", Array(mIdAux, DTFields(1).Value))
            If oRs.RecordCount > 0 Then
               txtCodigoDesde.Text = IIf(IsNull(oRs.Fields("Codigo1").Value), 0, oRs.Fields("Codigo1").Value)
            End If
            oRs.Close
            
            mIdAux = 0
            If IsNumeric(DataCombo1(1).BoundText) Then mIdAux = DataCombo1(1).BoundText
            Set DataCombo1(1).RowSource = Aplicacion.Cuentas.TraerFiltrado("_PorCodigoDescripcionParaCombo", DTFields(1).Value)
            DataCombo1(1).BoundText = mIdAux
            Set oRs = Aplicacion.Cuentas.TraerFiltrado("_PorIdConDatos", Array(mIdAux, DTFields(1).Value))
            If oRs.RecordCount > 0 Then
               txtCodigoHasta.Text = IIf(IsNull(oRs.Fields("Codigo1").Value), 0, oRs.Fields("Codigo1").Value)
            End If
            oRs.Close
         Else
            mIdAux = 0
            If IsNumeric(DataCombo1(0).BoundText) Then mIdAux = DataCombo1(0).BoundText
            Set DataCombo1(0).RowSource = Aplicacion.Cuentas.TraerFiltrado("_PorDescripcionCodigoParaCombo", DTFields(1).Value)
            DataCombo1(0).BoundText = mIdAux
            Set oRs = Aplicacion.Cuentas.TraerFiltrado("_PorIdConDatos", Array(mIdAux, DTFields(1).Value))
            If oRs.RecordCount > 0 Then
               txtCodigoDesde.Text = IIf(IsNull(oRs.Fields("Codigo1").Value), 0, oRs.Fields("Codigo1").Value)
            End If
            oRs.Close
            
            mIdAux = 0
            If IsNumeric(DataCombo1(1).BoundText) Then mIdAux = DataCombo1(1).BoundText
            Set DataCombo1(1).RowSource = Aplicacion.Cuentas.TraerFiltrado("_PorDescripcionCodigoParaCombo", DTFields(1).Value)
            DataCombo1(1).BoundText = mIdAux
            Set oRs = Aplicacion.Cuentas.TraerFiltrado("_PorIdConDatos", Array(mIdAux, DTFields(1).Value))
            If oRs.RecordCount > 0 Then
               txtCodigoHasta.Text = IIf(IsNull(oRs.Fields("Codigo1").Value), 0, oRs.Fields("Codigo1").Value)
            End If
            oRs.Close
         End If
      ElseIf Option7.Value Then
         mIdAux = 0
         If IsNumeric(DataCombo2(3).BoundText) Then mIdAux = DataCombo2(3).BoundText
         Set DataCombo2(3).RowSource = Aplicacion.Cuentas.TraerFiltrado("_PorFechaParaCombo", DTFields(1).Value)
         DataCombo2(3).BoundText = mIdAux
         Set oRs = Aplicacion.Cuentas.TraerFiltrado("_PorIdConDatos", Array(mIdAux, DTFields(1).Value))
         If oRs.RecordCount > 0 Then
            txtCodigoCuenta.Text = IIf(IsNull(oRs.Fields("Codigo1").Value), 0, oRs.Fields("Codigo1").Value)
         End If
         oRs.Close
      End If
      Set oRs = Nothing
   End If

End Sub

Private Sub Form_Load()

   On Error Resume Next
   
   Dim oRs As ADOR.Recordset
   Dim mvarEjercicio As Integer
   Dim mvarInicioEjercicio As Date, mvarFechaDesde As Date, mvarFechaHasta As Date
   
   Set oRs = Aplicacion.Parametros.Item(1).Registro
   mvarEjercicio = oRs.Fields("EjercicioActual").Value
   mvarDirectorioDTS = oRs.Fields("DirectorioDTS").Value
   mvarLineasDiarioDetallado = IIf(IsNull(oRs.Fields("LineasDiarioDetallado").Value), 60, oRs.Fields("LineasDiarioDetallado").Value)
   mvarLineasDiarioResumido = IIf(IsNull(oRs.Fields("LineasDiarioResumido").Value), 60, oRs.Fields("LineasDiarioResumido").Value)
   oRs.Close
   
   Set oRs = Aplicacion.TablasGenerales.TraerFiltrado("EjerciciosPeriodos", "_PorEjercicio", mvarEjercicio)
   mvarInicioEjercicio = oRs.Fields("FechaInicio").Value
   oRs.Close
   
   Set oRs = Nothing
   
'   DTFields(0).Value = mvarInicioEjercicio
'   DTFields(1).Value = Date
   
   mvarFechaDesde = DateSerial(Year(Date), Month(Date) - 1, 1)
   mvarFechaHasta = DateAdd("m", 1, mvarFechaDesde)
   mvarFechaHasta = DateAdd("d", -1, mvarFechaHasta)

   DTFields(0).Value = mvarFechaDesde
   DTFields(1).Value = mvarFechaHasta
   
   ReemplazarEtiquetas Me
   
   CambiarLenguaje Me, "esp", glbIdiomaActual

End Sub

Private Sub Form_Paint()

   Degradado Me
   
End Sub

Private Sub Lista_DblClick()

   If mvarCodigoInforme = 1 And Option12.Value Then
      If Len(Lista.SelectedItem.SubItems(10)) > 0 And Len(Lista.SelectedItem.SubItems(11)) > 0 Then
         EditarComprobante Lista.SelectedItem.SubItems(10), Lista.SelectedItem.SubItems(11)
      End If
   End If
   
End Sub

Private Sub Lista_FinCarga()

   CambiarLenguaje Me, "esp", glbIdiomaActual, "DbListView"
   
End Sub

Private Sub Lista_ItemClick(ByVal Item As MSComctlLib.IListItem)

   If mvarCodigoInforme = 1 And Option12.Value Then
      rchObservaciones.Text = Item.SubItems(14)
   End If

End Sub

Private Sub Option1_Click()

   If Option1.Value And mvarCodigoInforme < 100 Then
      txtCodigoDesde.Visible = False
      txtCodigoHasta.Visible = False
      DataCombo1(0).Visible = False
      DataCombo1(1).Visible = False
      lblLabels(0).Visible = False
      lblLabels(1).Visible = False
      lblLabels(2).Visible = True
      lblLabels(3).Visible = True
      lblLabels(5).Visible = False
      Frame4.Visible = False
      Frame5.Visible = False
      With DTFields(0)
         .Left = lblLabels(2).Left + lblLabels(2).Width + 10
         .Top = lblLabels(2).Top
      End With
      With DTFields(1)
         .Left = DTFields(0).Left
         .Top = lblLabels(3).Top
      End With
   End If
   
End Sub

Private Sub Option10_Click()

   Set DataCombo1(0).RowSource = Aplicacion.Cuentas.TraerFiltrado("_PorCodigoDescripcionParaCombo", DTFields(1).Value)
   Set DataCombo1(1).RowSource = Aplicacion.Cuentas.TraerFiltrado("_PorCodigoDescripcionParaCombo", DTFields(1).Value)
   DataCombo1(0).BoundText = Aplicacion.Cuentas.PrimerCuenta
   DataCombo1(1).BoundText = Aplicacion.Cuentas.UltimaCuenta

End Sub

Private Sub Option11_Click()

   Set DataCombo1(0).RowSource = Aplicacion.Cuentas.TraerFiltrado("_PorDescripcionCodigoParaCombo", DTFields(1).Value)
   Set DataCombo1(1).RowSource = Aplicacion.Cuentas.TraerFiltrado("_PorDescripcionCodigoParaCombo", DTFields(1).Value)
   DataCombo1(0).BoundText = Aplicacion.Cuentas.PrimerCuenta
   DataCombo1(1).BoundText = Aplicacion.Cuentas.UltimaCuenta

End Sub

Private Sub Option12_Click()

   If Option12.Value Then
      If mvarCodigoInforme = 0 Or mvarCodigoInforme = 17 Then
         Frame8.Visible = False
      Else
         rchObservaciones.Visible = True
      End If
   End If

End Sub

Private Sub Option13_Click()

   If Option13.Value Then
      If mvarCodigoInforme = 0 Or mvarCodigoInforme = 17 Then
         If BuscarClaveINI("Requerir nivel de agrupacion para diario") = "SI" Then
            With Frame8
               .Caption = "Resumir:"
               .Visible = True
            End With
            Check4.Caption = "Ventas"
            Check5.Caption = "Compras"
            Check6.Caption = "C./Bcos"
         End If
      Else
         rchObservaciones.Visible = False
      End If
   End If

End Sub

Private Sub Option2_Click()

   If Option2.Value Then
      txtCodigoDesde.Visible = True
      txtCodigoHasta.Visible = True
      DataCombo1(0).Visible = True
      DataCombo1(1).Visible = True
      lblLabels(0).Visible = True
      lblLabels(1).Visible = True
      lblLabels(2).Visible = True
      lblLabels(3).Visible = True
      lblLabels(5).Visible = False
      Frame4.Visible = False
      Frame5.Visible = True
      With DTFields(0)
         .Left = lblLabels(2).Left + lblLabels(2).Width + 10
         .Top = lblLabels(2).Top
      End With
      With DTFields(1)
         .Left = DTFields(0).Left
         .Top = lblLabels(3).Top
      End With
   End If
   
End Sub

Private Sub Option3_Click()

   If Option3.Value Then
      With Check9
         .Value = 0
         .Enabled = False
      End With
   End If

End Sub

Private Sub Option4_Click()

   If Option4.Value Then
      Check9.Enabled = True
   End If

End Sub

Private Sub Option7_Click()

   If Option7.Value And mvarCodigoInforme < 100 Then
      txtCodigoDesde.Visible = False
      txtCodigoHasta.Visible = False
      DataCombo1(0).Visible = False
      DataCombo1(1).Visible = False
      lblLabels(0).Visible = False
      lblLabels(1).Visible = False
      lblLabels(2).Visible = False
      lblLabels(3).Visible = False
      Frame5.Visible = False
      With Frame4
         .Top = Frame1.Top
         .Left = lblLabels(0).Left
         .Visible = True
      End With
      With lblLabels(5)
         .Top = Frame4.Top
         .Left = Frame4.Left + Frame4.Width + 10
         .Visible = True
      End With
      With DTFields(0)
         .Left = lblLabels(5).Left
         .Top = lblLabels(5).Top + lblLabels(5).Height
      End With
      With DTFields(1)
         .Left = lblLabels(5).Left
         .Top = DTFields(0).Top + DTFields(0).Height
      End With
   End If
   
End Sub

Private Sub Option8_Click()

   Set DataCombo2(3).RowSource = Aplicacion.Cuentas.TraerFiltrado("_PorCodigoDescripcionParaCombo", DTFields(1).Value)
   DataCombo2(3).Text = ""

End Sub

Private Sub Option9_Click()

   Set DataCombo2(3).RowSource = Aplicacion.Cuentas.TraerFiltrado("_PorDescripcionCodigoParaCombo", DTFields(1).Value)
   DataCombo2(3).Text = ""

End Sub

Private Sub Text1_GotFocus()

   With Text1
      .SelStart = 0
      .SelLength = Len(.Text)
   End With

End Sub

Private Sub Text1_KeyPress(KeyAscii As Integer)

   If KeyAscii = Asc(vbCr) Then SendKeys "{TAB}", True
   
End Sub

Private Sub Text2_GotFocus()

   With Text2
      .SelStart = 0
      .SelLength = Len(.Text)
   End With

End Sub

Private Sub Text2_KeyPress(KeyAscii As Integer)

   If KeyAscii = Asc(vbCr) Then SendKeys "{TAB}", True
   
End Sub

Private Sub txtCodigoCuenta_Change()

   If IsNumeric(txtCodigoCuenta.Text) Then
      Dim oRs As ADOR.Recordset
      Set oRs = Aplicacion.Cuentas.TraerFiltrado("_PorCodigo", Array(txtCodigoCuenta.Text, DTFields(1).Value))
      If oRs.RecordCount > 0 Then
         DataCombo2(3).BoundText = oRs.Fields(0).Value
      Else
         With DataCombo2(3)
            .BoundText = 0
            .Text = ""
         End With
      End If
      oRs.Close
      Set oRs = Nothing
   End If

End Sub

Private Sub txtCodigoCuenta_GotFocus()

   With txtCodigoCuenta
      .SelStart = 0
      .SelLength = Len(.Text)
   End With

End Sub

Private Sub txtCodigoCuenta_KeyPress(KeyAscii As Integer)

   If KeyAscii = Asc(vbCr) Then SendKeys "{TAB}", True

End Sub

Private Sub txtCodigoDesde_Change()

   If Len(txtCodigoDesde.Text) > 8 Then
      txtCodigoDesde.Text = mId(txtCodigoDesde.Text, 1, 10)
   End If
   
End Sub

Private Sub txtCodigoDesde_GotFocus()

   With txtCodigoDesde
      .SelStart = 0
      .SelLength = Len(.Text)
   End With

End Sub

Private Sub txtCodigoDesde_KeyPress(KeyAscii As Integer)

   If KeyAscii = Asc(vbCr) Then SendKeys "{TAB}", True
   
End Sub

Private Sub txtCodigoDesde_Validate(Cancel As Boolean)

   If Len(Trim(txtCodigoDesde.Text)) > 9 And mvarValidate Then
      MsgBox "La cuenta puede tener hasta 9 digitos", vbCritical
      Cancel = True
   ElseIf Len(Trim(txtCodigoDesde.Text)) <> 0 And mvarValidate Then
      Dim oRs As ADOR.Recordset
      Set oRs = Aplicacion.Cuentas.TraerFiltrado("_PorCodigo", Array(txtCodigoDesde.Text, DTFields(1).Value))
      If oRs.RecordCount < 1 Then
         MsgBox "Cuenta inexistente en archivo", vbCritical
         Cancel = True
      Else
         DataCombo1(0).BoundText = oRs.Fields(0).Value
      End If
      oRs.Close
      Set oRs = Nothing
   End If
   
End Sub

Private Sub txtCodigoHasta_Change()

   If Len(txtCodigoHasta.Text) > 8 And mvarValidate Then
      txtCodigoHasta.Text = mId(txtCodigoHasta.Text, 1, 10)
   End If
   
End Sub

Private Sub txtCodigoHasta_GotFocus()

   If Len(Trim(txtCodigoHasta.Text)) = 0 Then
      txtCodigoHasta.Text = txtCodigoDesde.Text
   Else
      With txtCodigoHasta
         .SelStart = 0
         .SelLength = Len(.Text)
      End With
   End If

End Sub

Private Sub txtCodigoHasta_KeyPress(KeyAscii As Integer)

   If KeyAscii = Asc(vbCr) Then SendKeys "{TAB}", True
   
End Sub

Private Sub txtCodigoHasta_Validate(Cancel As Boolean)

   If Len(Trim(txtCodigoHasta.Text)) > 9 And mvarValidate Then
      MsgBox "La cuenta puede tener hasta 9 digitos", vbCritical
      Cancel = True
   ElseIf Len(Trim(txtCodigoHasta.Text)) <> 0 And mvarValidate Then
      Dim oRs As ADOR.Recordset
      Set oRs = Aplicacion.Cuentas.TraerFiltrado("_PorCodigo", Array(txtCodigoHasta.Text, DTFields(1).Value))
      If oRs.RecordCount < 1 Then
         MsgBox "Cuenta inexistente en archivo", vbCritical
         Cancel = True
      Else
         DataCombo1(1).BoundText = oRs.Fields(0).Value
      End If
      oRs.Close
      Set oRs = Nothing
   End If
   
End Sub

Private Sub Toolbar1_ButtonClick(ByVal Button As MSComctlLib.Button)

   Dim mAuxS1 As String, mAuxS2 As String, mAuxS3 As String, mAuxS4 As String
   Dim mAuxS5 As String, mAuxS6 As String
   Dim mColumnaTransporte1 As Integer, mColumnaTransporte2 As Integer, mSeguro As Integer
   Dim mVector, mAux1
   
   Select Case Button.Key
      Case "Imprimir"
         If mvarCodigoInforme <> 0 And mvarCodigoInforme <> 17 Then
            ImprimirConExcel Lista, Me.Caption & mvarSubTituloExcel
         Else
            'DIARIO
            mAuxS1 = BuscarClaveINI("FontDiario")
            If Len(mAuxS1) = 0 Then mAuxS1 = "6"
            mAuxS2 = BuscarClaveINI("RowHeightDiario")
            If Len(mAuxS2) = 0 Then mAuxS2 = "8"
            mAuxS3 = BuscarClaveINI("Columnas transporte para diario")
            If Len(mAuxS3) > 0 Then
               mVector = VBA.Split(mAuxS3, ",")
               mColumnaTransporte1 = mVector(0)
               mColumnaTransporte2 = mVector(1)
            Else
               mColumnaTransporte1 = Lista.ColumnHeaders.Count - 2
               mColumnaTransporte2 = Lista.ColumnHeaders.Count - 1
            End If
            
            If BuscarClaveINI("Libros a TXT") = "SI" Then
               mAuxS4 = BuscarClaveINI("Ancho columnas diario")
               If Len(mAuxS4) > 0 Then mAuxS4 = "Columnas:" & mAuxS4
               With lblInfo
                  .Top = cmd(0).Top
                  .Left = cmd(0).Left + cmd(0).Width + 100
                  .Width = cmd(0).Width * 5
                  .Height = cmd(0).Height * 1.5
                  .Visible = True
               End With
               ArmarTXT Lista, "Diario", Me.Caption & mvarSubTituloExcel, _
                        mAuxS4 & _
                        "|LineasPorPagina:72" & _
                        "|PaginaInicial:" & Val(Text3.Text) & _
                        "|TransporteInicialDiario:" & Val(Text1.Text) & _
                        "|SumadorPorHoja1:" & mColumnaTransporte1 & _
                        "|SumadorPorHoja2:" & mColumnaTransporte2, Me
               lblInfo.Visible = False
               Exit Sub
            End If
            
            mAuxS5 = BuscarClaveINI("Macro para formatear diario general")
            If Len(mAuxS5) = 0 Then mAuxS5 = "FormatearDiarioGeneral"
            
            If Option12.Value Then
               ImprimirConExcel Lista, Me.Caption & mvarSubTituloExcel, _
                     mAuxS5 & "|FontDiario:" & mAuxS1 & _
                        ",RowHeightDiario:" & mAuxS2 & _
                        ",Empresa:" & glbEmpresa & _
                        ",Direccion:" & glbDatosAdicionales1 & _
                        ",Localidad:" & glbDatosAdicionales2 & _
                        "|" & Text3.Text & _
                        "|" & DTFields(1).Value, _
                     "SaltoDePaginaCada:" & Str(mvarLineasDiarioResumido) & _
                     "|SumadorPorHoja1:" & mColumnaTransporte1 & _
                     "|SumadorPorHoja2:" & mColumnaTransporte2 & _
                     "|PaginaInicial:" & Text3.Text & "|Enc:SinFecha" & _
                     "|TransporteInicialDiario:" & Text1.Text
            Else
               ImprimirConExcel Lista, Me.Caption & mvarSubTituloExcel, _
                     mAuxS5 & "|FontDiario:" & mAuxS1 & _
                        ",RowHeightDiario:" & mAuxS2 & _
                        ",Empresa:" & glbEmpresa & _
                        ",Direccion:" & glbDatosAdicionales1 & _
                        ",Localidad:" & glbDatosAdicionales2 & _
                        "|" & Text3.Text & _
                        "|" & DTFields(1).Value, _
                     "SaltoDePaginaCada:" & Str(mvarLineasDiarioDetallado) & _
                     "|SumadorPorHoja1:" & mColumnaTransporte1 & _
                     "|SumadorPorHoja2:" & mColumnaTransporte2 & _
                     "|PaginaInicial:" & Text3.Text & "|Enc:SinFecha" & _
                     "|TransporteInicialDiario:" & Text1.Text
            End If
         End If
      
      Case "Buscar"
         FiltradoLista Lista
         StatusBar1.Panels(2).Text = " " & Lista.ListItems.Count & " elementos en la lista"

      Case "Excel"
         If mvarCodigoInforme <> 0 And mvarCodigoInforme <> 17 Then
            ExportarAExcel Lista, Me.Caption & mvarSubTituloExcel
         Else
            'DIARIO
            mAuxS1 = BuscarClaveINI("FontDiario")
            If Len(mAuxS1) = 0 Then mAuxS1 = "6"
            mAuxS2 = BuscarClaveINI("RowHeightDiario")
            If Len(mAuxS2) = 0 Then mAuxS2 = "8"
            mAuxS3 = BuscarClaveINI("Columnas transporte para diario")
            If Len(mAuxS3) > 0 Then
               mVector = VBA.Split(mAuxS3, ",")
               mColumnaTransporte1 = mVector(0)
               mColumnaTransporte2 = mVector(1)
            Else
               mColumnaTransporte1 = Lista.ColumnHeaders.Count - 2
               mColumnaTransporte2 = Lista.ColumnHeaders.Count - 1
            End If
            mAuxS5 = BuscarClaveINI("Macro para formatear diario general")
            If Len(mAuxS5) = 0 Then mAuxS5 = "FormatearDiarioGeneral"
            
            If Option12.Value Then
               ExportarAExcel Lista, Me.Caption & mvarSubTituloExcel, _
                     mAuxS5 & "|FontDiario:" & mAuxS1 & _
                        ",RowHeightDiario:" & mAuxS2 & _
                        ",Empresa:" & glbEmpresa & _
                        ",Direccion:" & glbDatosAdicionales1 & _
                        ",Localidad:" & glbDatosAdicionales2 & _
                        "|" & Text3.Text & _
                        "|" & DTFields(1).Value, _
                     "SaltoDePaginaCada:" & Str(mvarLineasDiarioResumido) & _
                     "|SumadorPorHoja1:" & mColumnaTransporte1 & _
                     "|SumadorPorHoja2:" & mColumnaTransporte2 & _
                     "|PaginaInicial:" & Text3.Text & "|Enc:SinFecha" & _
                     "|TransporteInicialDiario:" & Text1.Text
            Else
               ExportarAExcel Lista, Me.Caption & mvarSubTituloExcel, _
                     mAuxS5 & "|FontDiario:" & mAuxS1 & _
                        ",RowHeightDiario:" & mAuxS2 & _
                        ",Empresa:" & glbEmpresa & _
                        ",Direccion:" & glbDatosAdicionales1 & _
                        ",Localidad:" & glbDatosAdicionales2 & _
                        "|" & Text3.Text & _
                        "|" & DTFields(1).Value, _
                     "SaltoDePaginaCada:" & Str(mvarLineasDiarioDetallado) & _
                     "|SumadorPorHoja1:" & mColumnaTransporte1 & _
                     "|SumadorPorHoja2:" & mColumnaTransporte2 & _
                     "|PaginaInicial:" & Text3.Text & "|Enc:SinFecha" & _
                     "|TransporteInicialDiario:" & Text1.Text
            End If
         End If
      
      Case "Diario"
         EmisionDiario Lista.DataSource, DTFields(0).Value, DTFields(1).Value, _
                        "" & Text1.Text & "|" & Text3.Text
   
      Case "Pdf"
         'DIARIO IGJ
         mSeguro = MsgBox("Se procedera a generar el copiado del libro diario" & vbCrLf & _
                "El sistema registrara como nueva fecha de cierre contable el " & DTFields(1).Value, vbYesNo)
         If mSeguro = vbNo Then Exit Sub
         mAuxS1 = BuscarClaveINI("FontDiario")
         If Len(mAuxS1) = 0 Then mAuxS1 = "6"
         mAuxS2 = BuscarClaveINI("RowHeightDiario")
         If Len(mAuxS2) = 0 Then mAuxS2 = "8"
         mAuxS3 = BuscarClaveINI("Columnas transporte para diario")
         If Len(mAuxS3) > 0 Then
            mVector = VBA.Split(mAuxS3, ",")
            mColumnaTransporte1 = mVector(0)
            mColumnaTransporte2 = mVector(1)
         Else
            mColumnaTransporte1 = Lista.ColumnHeaders.Count - 2
            mColumnaTransporte2 = Lista.ColumnHeaders.Count - 1
         End If
         mAuxS5 = BuscarClaveINI("Macro para formatear diario general")
         If Len(mAuxS5) = 0 Then mAuxS5 = "FormatearDiarioGeneral"
         'mAuxS6 = BuscarClaveINI("Emitir diario a pdf")
         
         If Option12.Value Then
            ExportarAExcel Lista, Me.Caption & mvarSubTituloExcel, _
                  mAuxS5 & "|FontDiario:" & mAuxS1 & _
                     ",RowHeightDiario:" & mAuxS2 & _
                     ",Empresa:" & glbEmpresa & _
                     ",Direccion:" & glbDatosAdicionales1 & _
                     ",Localidad:" & glbDatosAdicionales2 & _
                     "|" & Text3.Text & _
                     "|" & DTFields(1).Value, _
                  "SaltoDePaginaCada:" & Str(mvarLineasDiarioResumido) & _
                  "|SumadorPorHoja1:" & mColumnaTransporte1 & _
                  "|SumadorPorHoja2:" & mColumnaTransporte2 & _
                  "|PaginaInicial:" & Text3.Text & "|Enc:SinFecha" & _
                  "|TransporteInicialDiario:" & Text1.Text & _
                  "|PDF:SI"
         Else
            ExportarAExcel Lista, Me.Caption & mvarSubTituloExcel, _
                  mAuxS5 & "|FontDiario:" & mAuxS1 & _
                     ",RowHeightDiario:" & mAuxS2 & _
                     ",Empresa:" & glbEmpresa & _
                     ",Direccion:" & glbDatosAdicionales1 & _
                     ",Localidad:" & glbDatosAdicionales2 & _
                     "|" & Text3.Text & _
                     "|" & DTFields(1).Value, _
                  "SaltoDePaginaCada:" & Str(mvarLineasDiarioDetallado) & _
                  "|SumadorPorHoja1:" & mColumnaTransporte1 & _
                  "|SumadorPorHoja2:" & mColumnaTransporte2 & _
                  "|PaginaInicial:" & Text3.Text & "|Enc:SinFecha" & _
                  "|TransporteInicialDiario:" & Text1.Text & _
                  "|PDF:SI"
         End If
         
'         Dim oPar As ComPronto.Parametro
'         Set oPar = Aplicacion.Parametros.Item(1)
'         If DTFields(1).Value > oPar.Registro.Fields("FechaUltimoCierre").Value Then
'            oPar.Registro.Fields("FechaUltimoCierre").Value = DTFields(1).Value
'            oPar.Guardar
'            gblFechaUltimoCierre = DTFields(1).Value
'         End If
'         Set oPar = Nothing
         mAux1 = TraerValorParametro2("FechaEmisionDiarioIGJ")
         If IsNull(mAux1) Then
            GuardarValorParametro2 "FechaEmisionDiarioIGJ", "" & DTFields(1).Value
         Else
            If DTFields(1).Value > CDate(mAux1) Then
               GuardarValorParametro2 "FechaEmisionDiarioIGJ", "" & DTFields(1).Value
            End If
         End If

   End Select

End Sub

Public Function ArmarBalanceIndentado() As ADOR.Recordset

'   On Error GoTo Mal
   
   Dim oAp As ComPronto.Aplicacion
   Dim oRs As ADOR.Recordset
   Dim oRsCuentas As ADOR.Recordset
   Dim oRsMayor As ADOR.Recordset
   Dim oRsMayor1 As ADOR.Recordset
   Dim mvarPrimero As Boolean, mvarAgregarSubtotal As Boolean, mvarOK As Boolean
   Dim mvarEsSubtotal As Boolean, mvarSenialNivelTotales(4) As Boolean
   Dim mvarCuenta As Long, mCuentaDesde As Long, mCuentaHasta As Long
   Dim mvarCodCtrl As Long
   Dim i As Integer, mvarNivel As Integer, mvarEjercicioInicio As Integer
   Dim mMargen As Integer, mPos As Integer
   Dim mvarSaldo As Double, mvarSaldoInicial(4) As Double, mvarSaldoDebe(4) As Double
   Dim mvarSaldoHaber(4) As Double, mvarSaldoInicial1 As Double
   Dim mvarSaldoDebe1 As Double, mvarSaldoHaber1 As Double, mvarResultado As Double
   Dim mvarTSaldoInicial As Double, mvarTSaldoDebe As Double, mvarTSaldoHaber As Double
   Dim mvarFechaEjercicioInicial As Date
   Dim mControl(5) As String, mNombreCuenta(4) As String, mVectorX As String
   Dim mVectorT As String, mIncluirCierre As String, mVectorE As String
   Dim mIncluirApertura As String, mResumenCC As String, mJerarquia As String
   Dim mJerarquiaActual As String
   Dim mVector

   For i = 0 To 4
      mvarSaldoInicial(i) = 0
      mvarSaldoDebe(i) = 0
      mvarSaldoHaber(i) = 0
      mNombreCuenta(i) = ""
      mvarSenialNivelTotales(i) = True
   Next
   mvarTSaldoInicial = 0
   mvarTSaldoDebe = 0
   mvarTSaldoHaber = 0
   mvarResultado = 0
   mVectorX = "011100006666600133"
   mVectorT = "033000006666600900"
   
   mIncluirCierre = "NO"
   If Check7.Value = 1 Then mIncluirCierre = "SI"
   mIncluirApertura = "NO"
   If Check2.Value = 1 Then mIncluirApertura = "SI"
   mIncluirConsolidacion = "SI"
   If Check8.Visible And Check8.Value = 0 Then mIncluirConsolidacion = "NO"
   mResumenCC = "NO"
   If Check9.Value = 1 Then mResumenCC = "SI"
   
   Set oAp = Aplicacion
   
   mvarFechaEjercicioInicial = oAp.Cuentas.FechaEjercicioInicial(DTFields(0).Value)
   mvarEjercicioInicio = oAp.Cuentas.EjercicioInicial(DTFields(0).Value)
   If Option3.Value Then
      Set oRsCuentas = oAp.TablasGenerales.TraerFiltrado("Cuentas", _
                        "_DesdeHastaConSaldosConGastosTotalizados", _
                        Array(DTFields(0).Value, DTFields(1).Value, _
                              mvarEjercicioInicio - 1, mvarFechaEjercicioInicial, _
                              mIncluirCierre, mIncluirApertura, mIncluirConsolidacion))
   Else
      Set oRsCuentas = oAp.TablasGenerales.TraerFiltrado("Cuentas", _
                        "_DesdeHastaConSaldos", _
                        Array(DTFields(0).Value, DTFields(1).Value, _
                              mvarEjercicioInicio - 1, mvarFechaEjercicioInicial, _
                              mIncluirCierre, mIncluirApertura, mIncluirConsolidacion))
   End If
   Set oRsMayor = CopiarEstructura(oRsCuentas)
   Set oRsMayor1 = CopiarEstructura(oRsCuentas)
   
   If oRsCuentas.RecordCount > 0 Then
      oRsCuentas.MoveFirst
      mVector = VBA.Split(IIf(IsNull(oRsCuentas.Fields("Jerarquia").Value), "0.0.00.00.000", oRsCuentas.Fields("Jerarquia").Value), ".")
      mNombreCuenta(0) = oRsCuentas.Fields("Detalle").Value
      For i = 0 To 4: mControl(i) = mVector(i): Next
      mMargen = 0
      mvarNivel = 0
      mvarEmitio = False
      mVectorE = oRsCuentas.Fields("Vector_E").Value
      mJerarquia = IIf(IsNull(oRsCuentas.Fields("Jerarquia").Value), "0.0.00.00.000", oRsCuentas.Fields("Jerarquia").Value)
      
      Do While True
         If Not oRsCuentas.EOF Then
            txtProcesando.Text = "Procesando : " & oRsCuentas.Fields("Cuenta").Value & " " & oRsCuentas.Fields("Detalle").Value
            DoEvents
            mJerarquiaActual = IIf(IsNull(oRsCuentas.Fields("Jerarquia").Value), "0.0.00.00.000", oRsCuentas.Fields("Jerarquia").Value)
            If mJerarquiaActual <> "...." Then
               mVector = VBA.Split(oRsCuentas.Fields("Jerarquia").Value, ".")
            Else
               mVector = VBA.Split("0.0.00.00.000", ".")
            End If
         Else
            mVector = VBA.Split("9.0.00.00.000", ".")
         End If
         mPos = -1
         mvarEsSubtotal = False
         For i = 4 To 0 Step -1
            If i <= UBound(mVector) Then
               If mControl(i) <> mVector(i) Then
                  If mVector(4) = "000" Then mPos = i
                  mControl(i) = mVector(i)
                  If Len(mVector(i)) = 0 Then
                     mMargen = 0
                  Else
                     If CInt(mVector(i)) <> 0 Then mMargen = i * 5
                  End If
               End If
            Else
               mMargen = 0
            End If
            If IsNumeric(mVector(i)) Then If CInt(mVector(i)) = 0 Then mvarEsSubtotal = True
         Next
         If Not mvarEsSubtotal Then mMargen = 20
         
         If mPos <> -1 Then
            For i = 3 To mPos Step -1
               If mvarSaldoInicial(i) <> 0 Or mvarSaldoDebe(i) <> 0 Or mvarSaldoHaber(i) <> 0 Then
                  If mvarSenialNivelTotales(i) And Check3(i).Value = 1 Then
                     With oRsMayor
                        .AddNew
                        .Fields("Cuenta").Value = Null
                        .Fields("Detalle").Value = VBA.mId(Space((i + 1) * 5) & "-->Total " & mNombreCuenta(i), 1, .Fields("Detalle").DefinedSize)
                        .Fields("Vector_E").Value = " BOL | BOL | BOL | BOL,NUM:#COMMA##0.00 | BOL,NUM:#COMMA##0.00 | BOL,NUM:#COMMA##0.00 | BOL,NUM:#COMMA##0.00"
                        .Fields("Vector_X").Value = mVectorX
                        .Fields("Vector_T").Value = mVectorT
                        .Fields("Saldo inicial").Value = mvarSaldoInicial(i)
                        .Fields("Saldo deudor").Value = mvarSaldoDebe(i)
                        .Fields("Saldo acreedor").Value = mvarSaldoHaber(i)
                        .Fields("Saldo periodo").Value = Round(mvarSaldoDebe(i) - mvarSaldoHaber(i), 2)
                        .Fields("Saldo final").Value = Round(mvarSaldoInicial(i) + mvarSaldoDebe(i) - mvarSaldoHaber(i), 2)
                        .Update
                     End With
                     If mId(mJerarquia, 1, 1) > "5" And mResumenCC = "SI" Then
                        With oRsMayor1
                           .AddNew
                           .Fields("Cuenta").Value = Null
                           .Fields("Detalle").Value = VBA.mId(Space((i + 1) * 5) & "-->Total " & mNombreCuenta(i), 1, .Fields("Detalle").DefinedSize)
                           .Fields("Vector_E").Value = " BOL | BOL | BOL | BOL,NUM:#COMMA##0.00 | BOL,NUM:#COMMA##0.00 | BOL,NUM:#COMMA##0.00 | BOL,NUM:#COMMA##0.00"
                           .Fields("Vector_X").Value = mVectorX
                           .Fields("Vector_T").Value = mVectorT
                           .Fields("Saldo inicial").Value = mvarSaldoInicial(i)
                           .Fields("Saldo deudor").Value = mvarSaldoDebe(i)
                           .Fields("Saldo acreedor").Value = mvarSaldoHaber(i)
                           .Fields("Saldo periodo").Value = Round(mvarSaldoDebe(i) - mvarSaldoHaber(i), 2)
                           .Fields("Saldo final").Value = Round(mvarSaldoInicial(i) + mvarSaldoDebe(i) - mvarSaldoHaber(i), 2)
                           .Update
                        End With
                     End If
                  End If
               End If
               mvarSaldoInicial(i) = 0
               mvarSaldoDebe(i) = 0
               mvarSaldoHaber(i) = 0
               If mPos = i And Not oRsCuentas.EOF Then mNombreCuenta(i) = oRsCuentas.Fields("Detalle").Value
            Next
         End If
         
         If oRsCuentas.EOF Then
            If mResumenCC = "SI" Then
               oRsMayor.AddNew
               With oRsMayor
                  .AddNew
                  .Fields("Cuenta").Value = Null
                  .Fields("Detalle").Value = " TOTAL RESULTADOS NEGATIVOS"
                  .Fields("Vector_E").Value = " BOL | BOL | BOL | BOL,NUM:#COMMA##0.00 | BOL,NUM:#COMMA##0.00 | BOL,NUM:#COMMA##0.00 | BOL,NUM:#COMMA##0.00"
                  .Fields("Vector_X").Value = mVectorX
                  .Fields("Vector_T").Value = mVectorT
                  .Fields("Saldo final").Value = mvarResultado
                  .Update
               End With
            End If
            With oRsMayor
               .AddNew
               .AddNew
               .Fields("Cuenta").Value = "999999"
               .Fields("Detalle").Value = "TOTAL BALANCE"
               .Fields("Vector_E").Value = " BOL | BOL | BOL | BOL,NUM:#COMMA##0.00 | BOL,NUM:#COMMA##0.00 | BOL,NUM:#COMMA##0.00 | BOL,NUM:#COMMA##0.00"
               .Fields("Vector_X").Value = mVectorX
               .Fields("Vector_T").Value = mVectorT
               .Fields("Saldo inicial").Value = mvarTSaldoInicial
               .Fields("Saldo deudor").Value = mvarTSaldoDebe
               .Fields("Saldo acreedor").Value = mvarTSaldoHaber
               .Fields("Saldo periodo").Value = Round(mvarTSaldoDebe - mvarTSaldoHaber, 2)
               .Fields("Saldo final").Value = Round(mvarTSaldoInicial + mvarTSaldoDebe - mvarTSaldoHaber, 2)
               .AddNew
               .Update
            End With
            Exit Do
         End If
         
         For i = 0 To 4
            If IsNumeric(mVector(i)) Then
               If CInt(mVector(i)) = 0 Then
                  If i > 0 Then mvarSenialNivelTotales(i - 1) = True
                  For j = i To 4
                     mvarSenialNivelTotales(j) = False
                  Next
                  Exit For
               End If
            End If
         Next
         
         mvarSaldoInicial1 = 0
         mvarSaldoDebe1 = 0
         mvarSaldoHaber1 = 0
         
         Select Case oRsCuentas.Fields("IdTipoCuenta").Value
            Case 1
               With oRsMayor
                  .AddNew
                  .Fields("Cuenta").Value = oRsCuentas.Fields("Cuenta").Value
                  .Fields("Jerarquias").Value = oRsCuentas.Fields("Jerarquias").Value
                  .Fields("Detalle").Value = VBA.mId(Space(mMargen) & oRsCuentas.Fields("Detalle").Value, 1, oRsCuentas.Fields("Detalle").DefinedSize)
                  .Fields("IdTipoCuenta").Value = oRsCuentas.Fields("IdTipoCuenta").Value
                  .Fields("Vector_E").Value = mVectorE
                  .Fields("Vector_X").Value = mVectorX
                  .Fields("Vector_T").Value = mVectorT
                  .Update
               End With
            
            Case 3
'               With oRsMayor
'                  .AddNew
'                  .Fields("Cuenta").Value = oRsCuentas.Fields("Cuenta").Value
'                  .Fields("Jerarquias").Value = oRsCuentas.Fields("Jerarquias").Value
'                  .Fields("Detalle").Value = VBA.mId(Space(mMargen) & oRsCuentas.Fields("Detalle").Value, 1, 50)
'                  .Fields("Vector_X").Value = mVectorX
'                  .Fields("Vector_T").Value = mVectorT
'                  .Fields("Saldo inicial").Value = mvarSaldoInicial(mvarNivel)
'                  .Fields("Saldo deudor").Value = mvarSaldoDebe(mvarNivel)
'                  .Fields("Saldo acreedor").Value = mvarSaldoHaber(mvarNivel)
'                  .Fields("Saldo periodo").Value = mvarSaldoDebe(mvarNivel) - mvarSaldoHaber(mvarNivel)
'                  .Fields("Saldo final").Value = mvarSaldoInicial(mvarNivel) + mvarSaldoDebe(mvarNivel) - mvarSaldoHaber(mvarNivel)
'                  .Update
'               End With
'               For i = mvarNivel To 0 Step -1
'                  mvarSaldoInicial(i) = 0
'                  mvarSaldoDebe(i) = 0
'                  mvarSaldoHaber(i) = 0
'               Next
            
            Case Else
               If Not IsNull(oRsCuentas.Fields("SaldoDebeEjercicio").Value) Then
                  mvarSaldoInicial1 = mvarSaldoInicial1 + Round(oRsCuentas.Fields("SaldoDebeEjercicio").Value, 2)
               End If
               If Not IsNull(oRsCuentas.Fields("SaldoHaberEjercicio").Value) Then
                  mvarSaldoInicial1 = mvarSaldoInicial1 - Round(oRsCuentas.Fields("SaldoHaberEjercicio").Value, 2)
               End If
               If Not IsNull(oRsCuentas.Fields("SaldoDebeInicio").Value) Then
                  mvarSaldoInicial1 = mvarSaldoInicial1 + Round(oRsCuentas.Fields("SaldoDebeInicio").Value, 2)
               End If
               If Not IsNull(oRsCuentas.Fields("SaldoHaberInicio").Value) Then
                  mvarSaldoInicial1 = mvarSaldoInicial1 - Round(oRsCuentas.Fields("SaldoHaberInicio").Value, 2)
               End If
               
               If Not IsNull(oRsCuentas.Fields("Saldo deudor").Value) Then
                  mvarSaldoDebe1 = Round(oRsCuentas.Fields("Saldo deudor").Value, 2)
               End If
               If Not IsNull(oRsCuentas.Fields("Saldo acreedor").Value) Then
                  mvarSaldoHaber1 = Round(oRsCuentas.Fields("Saldo acreedor").Value, 2)
               End If
                  
               If mId(mJerarquiaActual, 1, 1) = "5" Or mId(mJerarquiaActual, 1, 1) = "8" Or mId(mJerarquiaActual, 1, 1) = "9" Then
                  mvarResultado = mvarResultado + Round(mvarSaldoInicial1 + mvarSaldoDebe1 - mvarSaldoHaber1, 2)
               End If
               
               If mvarSaldoInicial1 <> 0 Or mvarSaldoDebe1 <> 0 Or mvarSaldoHaber1 <> 0 Then
                  With oRsMayor
                     .AddNew
                     .Fields("Cuenta").Value = oRsCuentas.Fields("Cuenta").Value
                     .Fields("Jerarquias").Value = oRsCuentas.Fields("Jerarquias").Value
                     .Fields("Detalle").Value = VBA.mId(Space(mMargen) & oRsCuentas.Fields("Detalle").Value, 1, oRsCuentas.Fields("Detalle").DefinedSize)
                     .Fields("Vector_E").Value = mVectorE
                     .Fields("Vector_X").Value = mVectorX
                     .Fields("Vector_T").Value = mVectorT
                     .Fields("Saldo inicial").Value = mvarSaldoInicial1
                     .Fields("Saldo deudor").Value = mvarSaldoDebe1
                     .Fields("Saldo acreedor").Value = mvarSaldoHaber1
                     .Fields("Saldo periodo").Value = Round(mvarSaldoDebe1 - mvarSaldoHaber1, 2)
                     .Fields("Saldo final").Value = Round(mvarSaldoInicial1 + mvarSaldoDebe1 - mvarSaldoHaber1, 2)
                     .Update
                  End With
                  
                  For i = 0 To 4
                     mvarSaldoInicial(i) = Round(mvarSaldoInicial(i) + mvarSaldoInicial1, 2)
                     mvarSaldoDebe(i) = Round(mvarSaldoDebe(i) + mvarSaldoDebe1, 2)
                     mvarSaldoHaber(i) = Round(mvarSaldoHaber(i) + mvarSaldoHaber1, 2)
                  Next
                  mvarTSaldoInicial = Round(mvarTSaldoInicial + mvarSaldoInicial1, 2)
                  mvarTSaldoDebe = Round(mvarTSaldoDebe + mvarSaldoDebe1, 2)
                  mvarTSaldoHaber = Round(mvarTSaldoHaber + mvarSaldoHaber1, 2)
               End If
         End Select
         
         mJerarquia = IIf(IsNull(oRsCuentas.Fields("Jerarquia").Value), "0.0.00.00.000", oRsCuentas.Fields("Jerarquia").Value)
         oRsCuentas.MoveNext
      Loop
   End If
   
   oRsCuentas.Close
   
   If mResumenCC = "SI" And oRsMayor1.RecordCount > 0 Then
      oRsMayor.AddNew
      oRsMayor.Fields("Detalle").Value = "TOTALES POR CENTRO DE COSTOS"
      oRsMayor.Update
      oRsMayor1.MoveFirst
      Do While Not oRsMayor1.EOF
         With oRsMayor
            .AddNew
            .Fields("Cuenta").Value = oRsMayor1.Fields("Cuenta").Value
            .Fields("Jerarquias").Value = oRsMayor1.Fields("Jerarquias").Value
            .Fields("Detalle").Value = oRsMayor1.Fields("Detalle").Value
            .Fields("Vector_E").Value = mVectorE
            .Fields("Vector_X").Value = mVectorX
            .Fields("Vector_T").Value = mVectorT
            .Fields("Saldo inicial").Value = oRsMayor1.Fields("Saldo inicial").Value
            .Fields("Saldo deudor").Value = oRsMayor1.Fields("Saldo deudor").Value
            .Fields("Saldo acreedor").Value = oRsMayor1.Fields("Saldo acreedor").Value
            .Fields("Saldo periodo").Value = oRsMayor1.Fields("Saldo periodo").Value
            .Fields("Saldo final").Value = oRsMayor1.Fields("Saldo final").Value
            .Update
         End With
         oRsMayor1.MoveNext
      Loop
   End If
   oRsMayor1.Close
   
   With oRsMayor
      If .RecordCount > 0 Then
         .MoveFirst
         Do While Not .EOF
            If mId(.Fields("Jerarquias").Value, 1, 1) >= "6" And _
                  IIf(IsNull(.Fields("IdTipoCuenta").Value), 0, .Fields("IdTipoCuenta").Value) = 1 Then
               mvarOK = False
               .MoveNext
               If Not .EOF Then
                  If Right(.Fields("Jerarquias").Value, 3) = "000" And _
                        Not mId(.Fields("Jerarquias").Value, 5, 9) = "00.00.000" And _
                        IIf(IsNull(.Fields("IdTipoCuenta").Value), 0, .Fields("IdTipoCuenta").Value) = 1 Then
                     mvarOK = True
                  End If
               End If
               .MovePrevious
               If mvarOK Then .Delete
            End If
            .MoveNext
         Loop
         .MoveFirst
      End If
   End With
   
   Set ArmarBalanceIndentado = oRsMayor
   
Salida:

   Set oRsCuentas = Nothing
   Set oRsIni = Nothing
   Set oRs = Nothing
   Set oRsMayor = Nothing
   Set oRsMayor1 = Nothing
   Set oAp = Nothing
   
   Exit Function
   
Mal:

   Select Case Err.Number
      Case Else
         MsgBox "Se ha producido un error al procesar los datos" & vbCrLf & Err.Number & " -> " & Err.Description, vbCritical
   End Select
   Set ArmarBalanceIndentado = Nothing
   Resume Salida

End Function

Private Sub EditarComprobante(ByVal TipoComprobante As Long, ByVal Identificador As Long)

   Dim oF As Form
      
   Select Case TipoComprobante
      Case 1
         Set oF = New frmFacturas
      Case 2
         Set oF = New frmRecibos
      Case 3
         Set oF = New frmNotasDebito
      Case 4
         Set oF = New frmNotasCredito
      Case 5
         Set oF = New frmDevoluciones
      Case 10, 11, 13, 18, 19, 31, 34
         Set oF = New frmComprobantesPrv
      Case 14
         Set oF = New frmDepositosBancarios
      Case 17
         Set oF = New frmOrdenesPago
      Case 28, 29
         Set oF = New frmValoresGastos
      Case 38
         Set oF = New frmAsientos
      Case 39
         Set oF = New FrmPlazosFijos
      
      Case Else
         MsgBox "Comprobante no editable"
         GoTo Salida:
   End Select
   
   With oF
      .Id = Identificador
      .Disparar = ActL
      .Show vbModal, Me
   End With

Salida:

   Set oF = Nothing

End Sub

Public Sub ExportarBalanceAExcel(ByRef mLista As DbListView, ByVal Nivel As String)

   If mLista.ListItems.Count = 0 Then
      MsgBox "No hay elementos para exportar", vbExclamation
      Exit Sub
   End If
   
   Dim s As String, mvarPlanilla As String
   Dim fl As Integer, cl As Integer
   Dim oEx As Excel.Application
   Dim oL As ListItem
   Dim oS As ListSubItem
   Dim oCol As ColumnHeader
   
   If Nivel = "Cuenta" Then
      mvarPlanilla = "Balance.xlt"
   Else
      mvarPlanilla = "BalanceDetallado.xlt"
   End If
   
   Set oEx = CreateObject("Excel.Application")
   
   With oEx
      
      .Visible = True
      
      With .Workbooks.Add(glbPathPlantillas & "\" & mvarPlanilla)
         
         With .ActiveSheet

            cl = 1
            For Each oCol In mLista.ColumnHeaders
               .Cells(1, cl) = oCol.Text
               cl = cl + 1
            Next

            fl = 2
            For Each oL In mLista.ListItems
               cl = 1
               If Len(Trim(oL.Text)) <> 0 Then
                  .Cells(fl, cl) = oL.Text
               End If
               For Each oS In oL.ListSubItems
                  cl = cl + 1
                  If Len(Trim(oS.Text)) <> 0 Then
                     If mLista.TipoDatoColumna(cl - 1) = "D" Then
                        .Cells(fl, cl) = CDate(oS.Text)
                     Else
                        .Cells(fl, cl) = oS.Text
                     End If
                  End If
               Next
               fl = fl + 1
            Next
            
            .Range("A1").Select

         End With
         
         oEx.Run "ArmarTablaDinamica", DTFields(0).Value, DTFields(1).Value
      
      End With
      
   End With
   
   Set oEx = Nothing

End Sub

Public Sub AbrirCuboBalanceEnExcel()

   Dim oEx As Excel.Application
   
   Set oEx = CreateObject("Excel.Application")
   
   With oEx
      .Visible = True
      .Workbooks.Add (glbPathPlantillas & "\BalanceDetalladoCubo_" & glbEmpresaSegunString & ".XLT")
      .Run "RefrescarEnlaceACubo", DTFields(0).Value, DTFields(1).Value
   End With
   
   Set oEx = Nothing

End Sub

Public Sub AbrirCuboPresupuestoEconomicoEnExcel()

   Dim oEx As Excel.Application
   
   Set oEx = CreateObject("Excel.Application")
   
   With oEx
      .Visible = True
      .Workbooks.Add (glbPathPlantillas & "\PresupuestoEconomico_" & glbEmpresaSegunString & ".XLT")
      .Run "RefrescarEnlaceACubo", DataCombo1(0).Text
   End With
   
   Set oEx = Nothing

End Sub

